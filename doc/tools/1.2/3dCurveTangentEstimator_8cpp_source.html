<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>DGtalTools: 3dCurveTangentEstimator.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-green.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtalTools 
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ad421f26fc787a8055cabb4d5b02df31.html">estimators</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">3dCurveTangentEstimator.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;CLI11.hpp&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;DGtal/base/Common.h&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;DGtal/base/Exceptions.h&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;DGtal/kernel/SpaceND.h&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;DGtal/kernel/domains/HyperRectDomain.h&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;DGtal/kernel/BasicPointPredicates.h&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;DGtal/math/linalg/EigenDecomposition.h&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;DGtal/topology/KhalimskySpaceND.h&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/curves/GridCurve.h&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/curves/Naive3DDSSComputer.h&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/curves/StandardDSS6Computer.h&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/curves/SaturatedSegmentation.h&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/volumes/distance/ExactPredicateLpSeparableMetric.h&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/volumes/estimation/VoronoiCovarianceMeasure.h&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/curves/estimation/LambdaMST3D.h&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;DGtal/geometry/curves/estimation/FunctorsLambdaMST.h&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;DGtal/io/viewers/Viewer3D.h&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;DGtal/io/readers/PointListReader.h&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;DGtal/io/DrawWithDisplay3DModifier.h&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceDGtal.html">DGtal</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">const</span> Color  AXIS_COLOR( 0, 0, 0, 255 );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> AXIS_LINESIZE = 0.1;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">const</span> Color  XY_COLOR( 0, 0, 255, 50 );</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">const</span> Color  XZ_COLOR( 0, 255, 0, 50 );</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">const</span> Color  YZ_COLOR( 255, 0, 0, 50 );</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">const</span> Color  CURVE3D_COLOR( 100, 100, 140, 128 );</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">const</span> Color  CURVE2D_COLOR( 200, 200, 200, 100 );</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> MS3D_LINESIZE = 0.05;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">// Functions for displaying the tangential cover of a 3D curve.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Po<span class="keywordtype">int</span>, <span class="keyword">typename</span> RealPo<span class="keywordtype">int</span>, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordtype">void</span> displayAxes( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                  <span class="keyword">const</span> Point &amp; lowerBound, <span class="keyword">const</span> Point &amp; upperBound,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                  <span class="keyword">const</span> std::string &amp; mode )</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  RealPoint p0( (<span class="keywordtype">double</span>)lowerBound[ 0 ]-0.5,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                (<span class="keywordtype">double</span>)lowerBound[ 1 ]-0.5,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                (<span class="keywordtype">double</span>)lowerBound[ 2 ]-0.5 );</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  RealPoint p1( (<span class="keywordtype">double</span>)upperBound[ 0 ]-0.5,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                (<span class="keywordtype">double</span>)upperBound[ 1 ]-0.5,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                (<span class="keywordtype">double</span>)upperBound[ 2 ]-0.5 );</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> ( ( mode == <span class="stringliteral">&quot;WIRED&quot;</span> ) || ( mode == <span class="stringliteral">&quot;COLORED&quot;</span> ) )</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    viewer.setLineColor(AXIS_COLOR);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p0[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p0[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p0[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p0[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    viewer.addLine( DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p1[ 2 ]),  AXIS_LINESIZE );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span> ( mode == <span class="stringliteral">&quot;COLORED&quot;</span> )</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    viewer.setFillColor(XY_COLOR);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    viewer.addQuad(DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                   DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                   DGtal::Z3i::RealPoint(p0[ 0 ], p0[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                   DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p1[ 2 ]) );</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    viewer.setFillColor(XZ_COLOR);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    viewer.addQuad(DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                   DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                   DGtal::Z3i::RealPoint(p0[ 0 ], p1[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                   DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p0[ 2 ]));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    viewer.setFillColor(YZ_COLOR);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    viewer.addQuad(DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                   DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p1[ 2 ]),</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                   DGtal::Z3i::RealPoint(p1[ 0 ], p0[ 1 ], p0[ 2 ]),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                   DGtal::Z3i::RealPoint(p1[ 0 ], p1[ 1 ], p0[ 2 ]));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> Naive3DDSSComputer, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">void</span> displayDSS3d( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                   <span class="keyword">const</span> KSpace &amp; ks, <span class="keyword">const</span> Naive3DDSSComputer &amp; dss3d,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                   <span class="keyword">const</span> DGtal::Color &amp; color3d )</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  viewer &lt;&lt; CustomColors3D( color3d, color3d ) &lt;&lt; dss3d;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Po<span class="keywordtype">int</span>1, <span class="keyword">typename</span> Po<span class="keywordtype">int</span>2&gt;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordtype">void</span> assign( Point1 &amp; p1, <span class="keyword">const</span> Point2 &amp; p2 )</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  p1[ 0 ] = p2[ 0 ];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  p1[ 1 ] = p2[ 1 ];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  p1[ 2 ] = p2[ 2 ];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> Naive3DDSSComputer, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordtype">void</span> displayDSS3dTangent( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                          <span class="keyword">const</span> KSpace &amp; ks, <span class="keyword">const</span> Naive3DDSSComputer &amp; dss3d,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                          <span class="keyword">const</span> DGtal::Color &amp; color3d )</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Naive3DDSSComputer::Point3d Point;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Naive3DDSSComputer::Integer Integer;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Naive3DDSSComputer::PointR3d PointR3d;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Display3D&lt;&gt;::BallD3D PointD3D;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  Point directionZ3;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  PointR3d interceptR, thicknessR;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  Z3i::RealPoint P1, P2, direction, intercept, thickness;  </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  dss3d.getParameters( directionZ3, interceptR, thicknessR );</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  intercept[0] = (double) NumberTraits&lt;Integer&gt;::castToDouble ( interceptR[0].first ) / (double) NumberTraits&lt;Integer&gt;::castToDouble ( interceptR[0].second );</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  intercept[1] = (double) NumberTraits&lt;Integer&gt;::castToDouble ( interceptR[1].first ) / (double) NumberTraits&lt;Integer&gt;::castToDouble ( interceptR[1].second );</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  intercept[2] = (double) NumberTraits&lt;Integer&gt;::castToDouble ( interceptR[2].first ) / (double) NumberTraits&lt;Integer&gt;::castToDouble ( interceptR[2].second );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  thickness[0] = (double) NumberTraits&lt;Integer&gt;::castToDouble ( thicknessR[0].first ) / (double) NumberTraits&lt;Integer&gt;::castToDouble ( thicknessR[0].second );</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  thickness[1] = (double) NumberTraits&lt;Integer&gt;::castToDouble ( thicknessR[1].first ) / (double) NumberTraits&lt;Integer&gt;::castToDouble ( thicknessR[1].second );</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  thickness[2] = (double) NumberTraits&lt;Integer&gt;::castToDouble ( thicknessR[2].first ) / (double) NumberTraits&lt;Integer&gt;::castToDouble ( thicknessR[2].second );</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  assign( direction, directionZ3 );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  direction /= direction.norm();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  assign( P1, *dss3d.begin() );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  assign( P2, *(dss3d.end()-1) );</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">double</span> t1 = (P1 - intercept).dot( direction );</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordtype">double</span> t2 = (P2 - intercept).dot( direction );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  Z3i::RealPoint Q1 = intercept + t1 * direction;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  Z3i::RealPoint Q2 = intercept + t2 * direction;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  viewer.setLineColor(color3d);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  viewer.addLine( Z3i::RealPoint(Q1[ 0 ]-0.5, Q1[ 1 ]-0.5, Q1[ 2 ]-0.5),</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                  Z3i::RealPoint(Q2[ 0 ]-0.5, Q2[ 1 ]-0.5, Q2[ 2 ]-0.5),</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                  MS3D_LINESIZE );</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> StandardDSS6Computer, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">void</span> displayProj2d6( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keyword">const</span> KSpace &amp; ks, <span class="keyword">const</span> StandardDSS6Computer &amp; dss3d,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keyword">const</span> DGtal::Color &amp; color2d )</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> StandardDSS6Computer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::ConstIterator ConstIterator2d;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::Point Point2d;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Cell Cell;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Point Point3d;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  Point3d b = ks.lowerBound();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">for</span> ( DGtal::Dimension i = 0; i &lt; 3; ++i )</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dss2d = dss3d.arithmeticalDSS2d( i );</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">for</span> ( ConstIterator2d itP = dss2d.begin(), itPEnd = dss2d.end(); itP != itPEnd; ++itP )</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    Point2d p = *itP;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    Point3d q;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">switch</span> (i) </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">case</span> 0: q = Point3d( 2*b[ i ]  , 2*p[ 0 ]+1, 2*p[ 1 ]+1 ); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">case</span> 1: q = Point3d( 2*p[ 0 ]+1, 2*b[ i ]  , 2*p[ 1 ]+1 ); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">case</span> 2: q = Point3d( 2*p[ 0 ]+1, 2*p[ 1 ]+1, 2*b[ i ]   ); <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    Cell c = ks.uCell( q );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> StandardDSS6Computer, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">void</span> displayDSS2d6( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;       <span class="keyword">const</span> KSpace &amp; ks, <span class="keyword">const</span> StandardDSS6Computer &amp; dss3d,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;       <span class="keyword">const</span> DGtal::Color &amp; color2d )</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> StandardDSS6Computer::ConstIterator ConstIterator3d;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> StandardDSS6Computer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::ConstIterator ConstIterator2d;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::Point Point2d;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Cell Cell;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Point Point3d;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keyword">typedef</span> DGtal::PointVector&lt;2,double&gt; PointD2d;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Display3D&lt;&gt;::BallD3D PointD3D;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  Point3d b = ks.lowerBound();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">for</span> ( DGtal::Dimension i = 0; i &lt; 3; ++i )</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">const</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::Primitive &amp; dss2d</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  = dss3d.arithmeticalDSS2d( i ).primitive();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// draw 2D bounding boxes for each arithmetical dss 2D.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      std::vector&lt;PointD2d&gt; pts2d;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      pts2d.push_back( dss2d.project(dss2d.back(), dss2d.Uf()) );</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      pts2d.push_back( dss2d.project(dss2d.back(), dss2d.Lf()) );</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      pts2d.push_back( dss2d.project(dss2d.front(), dss2d.Lf()) );</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      pts2d.push_back( dss2d.project(dss2d.front(), dss2d.Uf()) );</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      std::vector&lt;PointD3D&gt; bb;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      PointD3D p3;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; pts2d.size(); ++j )</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">switch</span> (i) </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">case</span> 0: p3.center[0] = (double) b[ i ]-0.5; p3.center[1] = pts2d[ j ][ 0 ];  p3.center[2] = pts2d[ j ][ 1 ]; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">case</span> 1: p3.center[0] = pts2d[ j ][ 0 ];  p3.center[1] = (double) b[ i ]-0.5; p3.center[2] = pts2d[ j ][ 1 ];     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">case</span> 2: p3.center[0] = pts2d[ j ][ 0 ];  p3.center[1] = pts2d[ j ][ 1 ];     p3.center[2] = (double) b[ i ]-0.5; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    bb.push_back( p3 );</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; pts2d.size(); ++j ){</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  viewer.setLineColor(color2d);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  viewer.addLine( DGtal::Z3i::RealPoint(bb[ j ].center[0], bb[ j ].center[1], bb[ j ].center[2]),</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        DGtal::Z3i::RealPoint(bb[ (j+1)%4 ].center[0], bb[ (j+1)%4 ].center[1], bb[ (j+1)%4 ].center[2]),</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      MS3D_LINESIZE );</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    } <span class="comment">// for ( DGtal::Dimension i = 0; i &lt; 3; ++i )</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//Why not to just project 3D curve?</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> Naive3DDSSComputer, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">void</span> displayProj2d26( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    <span class="keyword">const</span> KSpace &amp; ks, <span class="keyword">const</span> Naive3DDSSComputer &amp; dss3d,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    <span class="keyword">const</span> DGtal::Color &amp; color2d )</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Naive3DDSSComputer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::ConstIterator ConstIterator2d;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::Point Point2d;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Cell Cell;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Point Point3d;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  Point3d b = ks.lowerBound();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssXY = dss3d.arithmeticalDSS2dXY();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssXZ = dss3d.arithmeticalDSS2dXZ();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssYZ = dss3d.arithmeticalDSS2dYZ();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">bool</span> validXY = dss3d.validArithmeticalDSS2d ( 2 );</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">bool</span> validXZ = dss3d.validArithmeticalDSS2d ( 1 );</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">bool</span> validYZ = dss3d.validArithmeticalDSS2d ( 0 );</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">if</span> ( validXY &amp;&amp; validXZ ) </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  { <span class="comment">//XY-plane, XZ-plane</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> ( ConstIterator2d itXY = dssXY.begin(), itXZ = dssXZ.begin(), itPEnd = dssXY.end(); itXY != itPEnd; ++itXY, ++itXZ )</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      Point2d p1 = *itXY, p2 = *itXZ;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      Point3d q1, q2, q3;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      q1 = Point3d ( 2*b[ 0 ], 2*p1[ 1 ]+1, 2*p2[ 1 ]+1 );</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      q2 = Point3d ( 2*p2[ 0 ]+1, 2*b[ 1 ], 2*p2[ 1 ]+1 );</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      q3 = Point3d ( 2*p1[ 0 ]+1, 2*p1[ 1 ]+1, 2*b[ 2 ] );</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      Cell c1 = ks.uCell( q1 ); Cell c2 = ks.uCell( q2 ); Cell c3 = ks.uCell( q3 );</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c1;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c2;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c3;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }  </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> ( validYZ &amp;&amp; validXY ) </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    { <span class="comment">//XY-plane, YZ-plane</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">for</span> ( ConstIterator2d itYZ = dssYZ.begin(), itXY = dssXY.begin(), itPEnd = dssXY.end(); itXY != itPEnd; ++itXY, ++itYZ )</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        Point2d p1 = *itYZ, p2 = *itXY;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        Point3d q1, q2, q3;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        q1 = Point3d ( 2*b[ 0 ], 2*p1[ 0 ]+1, 2*p1[ 1 ]+1 );</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        q2 = Point3d ( 2*p2[ 0 ]+1, 2*b[ 1 ], 2*p1[ 1 ]+1 );</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        q3 = Point3d ( 2*p2[ 0 ]+1, 2*p2[ 1 ]+1, 2*b[ 2 ] );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        Cell c1 = ks.uCell( q1 ); Cell c2 = ks.uCell( q2 ); Cell c3 = ks.uCell( q3 );</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c1;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c2;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c3;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    } </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">for</span> ( ConstIterator2d itYZ = dssYZ.begin(), itXZ = dssXZ.begin(), itPEnd = dssXZ.end(); itXZ != itPEnd; ++itXZ, ++itYZ )</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        Point2d p1 = *itYZ, p2 = *itXZ;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        Point3d q1, q2, q3;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        q1 = Point3d ( 2*b[ 0 ], 2*p1[ 0 ]+1, 2*p1[ 1 ]+1 );</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        q2 = Point3d ( 2*p2[ 0 ]+1, 2*b[ 1 ], 2*p2[ 1 ]+1 );</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        q3 = Point3d ( 2*p2[ 0 ]+1, 2*p1[ 0 ]+1, 2*b[ 2 ] );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        Cell c1 = ks.uCell( q1 ); Cell c2 = ks.uCell( q2 );Cell c3 = ks.uCell( q3 );</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c2;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        viewer &lt;&lt; CustomColors3D( color2d, color2d ) &lt;&lt; c3;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> Naive3DDSSComputer, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordtype">void</span> displayDSS2d26( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                   <span class="keyword">const</span> KSpace &amp; ks, <span class="keyword">const</span> Naive3DDSSComputer &amp; dss3d,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                   <span class="keyword">const</span> DGtal::Color &amp; color2d )</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Naive3DDSSComputer::ConstIterator ConstIterator3d;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Naive3DDSSComputer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::ConstIterator ConstIterator2d;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::Point Point2d;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Cell Cell;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Point Point3d;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">typedef</span> DGtal::PointVector&lt;2,double&gt; PointD2d;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Display3D&lt;&gt;::BallD3D PointD3D;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  Point3d b = ks.lowerBound();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">for</span> ( DGtal::Dimension i = 0; i &lt; 3; ++i )</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> ( !dss3d.validArithmeticalDSS2d ( i ) )</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> ArithmeticalDSSComputer2d::Primitive &amp; dss2d</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    = dss3d.arithmeticalDSS2d( i ).primitive();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// draw 2D bounding boxes for each arithmetical dss 2D.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    std::vector&lt;PointD2d&gt; pts2d;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    pts2d.push_back( dss2d.project(dss2d.back(), dss2d.Uf()) );</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    pts2d.push_back( dss2d.project(dss2d.back(), dss2d.Lf()) );</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    pts2d.push_back( dss2d.project(dss2d.front(), dss2d.Lf()) );</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    pts2d.push_back( dss2d.project(dss2d.front(), dss2d.Uf()) );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    std::vector&lt;PointD3D&gt; bb;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    PointD3D p3;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; pts2d.size(); ++j )</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">switch</span> (i) </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">case</span> 0: p3.center[0] = (double) b[ i ]-0.5; p3.center[1] = pts2d[ j ][ 0 ];  p3.center[2] = pts2d[ j ][ 1 ]; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">case</span> 1: p3.center[0] = pts2d[ j ][ 0 ];  p3.center[1] = (double) b[ i ]-0.5; p3.center[2] = pts2d[ j ][ 1 ];     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">case</span> 2: p3.center[0] = pts2d[ j ][ 0 ];  p3.center[1] = pts2d[ j ][ 1 ];     p3.center[2] = (double) b[ i ]-0.5; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      bb.push_back( p3 );</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; pts2d.size(); ++j ){</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      viewer.setLineColor(color2d);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      viewer.addLine( DGtal::Z3i::RealPoint(bb[ j ].center[0], bb[ j ].center[1], bb[ j ].center[2]),</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                      DGtal::Z3i::RealPoint(bb[ (j+1)%4 ].center[0], bb[ (j+1)%4 ].center[1], bb[ (j+1)%4 ].center[2]),</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                      MS3D_LINESIZE );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  } <span class="comment">// for ( DGtal::Dimension i = 0; i &lt; 3; ++i )</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordtype">bool</span> displayCover6( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;       <span class="keyword">const</span> KSpace &amp; ks, PointIterator b, PointIterator e,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;       <span class="keywordtype">bool</span> dss3d, <span class="keywordtype">bool</span> proj2d, <span class="keywordtype">bool</span> dss2d, <span class="keywordtype">bool</span> tangent,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;       <span class="keywordtype">int</span> nbColors )</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;{</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> PointIterator::value_type Point;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">typedef</span> StandardDSS6Computer&lt;PointIterator,int,4&gt; SegmentComputer;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">typedef</span> SaturatedSegmentation&lt;SegmentComputer&gt; Decomposition;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::SegmentComputerIterator SegmentComputerIterator;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  SegmentComputer algo;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  Decomposition theDecomposition(b, e, algo);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  viewer &lt;&lt; SetMode3D( algo.className(), <span class="stringliteral">&quot;BoundingBox&quot;</span> );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  HueShadeColorMap&lt;int&gt; cmap_hue( 0, nbColors, 1 );</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = 0;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">for</span> ( SegmentComputerIterator i = theDecomposition.begin();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        i != theDecomposition.end(); ++i)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      SegmentComputer ms3d(*i);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssXY = ms3d.arithmeticalDSS2dXY();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssXZ = ms3d.arithmeticalDSS2dXZ();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssYZ = ms3d.arithmeticalDSS2dYZ();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      Point f = *ms3d.begin();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      Point l = *(ms3d.end() - 1);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      trace.info() &lt;&lt; <span class="stringliteral">&quot;- &quot;</span> &lt;&lt; c</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; MS3D,&quot;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; f[ 0 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; f[ 1 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>&lt;&lt; f[ 2 ] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;-&gt;[&quot;</span> &lt;&lt; l[ 0 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; l[ 1 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>&lt;&lt; l[ 2 ] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;, XY(&quot;</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                   &lt;&lt; dssXY.a() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXY.b() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXY.mu()</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;), XZ(&quot;</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                   &lt;&lt; dssXZ.a() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXZ.b() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXZ.mu()</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;), YZ(&quot;</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                   &lt;&lt; dssYZ.a() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssYZ.b() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssYZ.mu()</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      Color color = cmap_hue( c );</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">if</span> ( tangent ) displayDSS3dTangent( viewer, ks, ms3d, color );</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">if</span> ( dss3d )   displayDSS3d( viewer, ks, ms3d, color );</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">if</span> ( dss2d )   displayDSS2d6( viewer, ks, ms3d, color );</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">if</span> ( proj2d )  displayProj2d6( viewer, ks, ms3d, CURVE2D_COLOR );</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      c++;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> KSpace, <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> space, <span class="keyword">typename</span> kspace &gt;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordtype">bool</span> displayCover26( Viewer3D&lt;space, kspace&gt; &amp; viewer,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                   <span class="keyword">const</span> KSpace &amp; ks, PointIterator b, PointIterator e,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                   <span class="keywordtype">bool</span> dss3d, <span class="keywordtype">bool</span> proj2d, <span class="keywordtype">bool</span> dss2d, <span class="keywordtype">bool</span> tangent,</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                   <span class="keywordtype">int</span> nbColors )</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;{</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> PointIterator::value_type Point;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">typedef</span> Naive3DDSSComputer&lt;PointIterator,int, 8 &gt; SegmentComputer;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keyword">typedef</span> SaturatedSegmentation&lt;SegmentComputer&gt; Decomposition;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::SegmentComputerIterator SegmentComputerIterator;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  SegmentComputer algo;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  Decomposition theDecomposition(b, e, algo);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  viewer &lt;&lt; SetMode3D( algo.className(), <span class="stringliteral">&quot;BoundingBox&quot;</span> );</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  HueShadeColorMap&lt;int&gt; cmap_hue( 0, nbColors, 1 );</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = 0;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">for</span> ( SegmentComputerIterator i = theDecomposition.begin();</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;       i != theDecomposition.end(); ++i)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;       {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         SegmentComputer ms3d(*i);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;         <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssXY = ms3d.arithmeticalDSS2dXY();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;         <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssXZ = ms3d.arithmeticalDSS2dXZ();</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         <span class="keyword">const</span> ArithmeticalDSSComputer2d &amp; dssYZ = ms3d.arithmeticalDSS2dYZ();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         Point f = *ms3d.begin();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;         Point l = *(ms3d.end() - 1);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;         trace.info() &lt;&lt; <span class="stringliteral">&quot;- &quot;</span> &lt;&lt; c</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; MS3D,&quot;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; f[ 0 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; f[ 1 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>&lt;&lt; f[ 2 ] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;-&gt;[&quot;</span> &lt;&lt; l[ 0 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; l[ 1 ] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>&lt;&lt; l[ 2 ] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;, XY(&quot;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         &lt;&lt; dssXY.a() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXY.b() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXY.mu()</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;), XZ(&quot;</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         &lt;&lt; dssXZ.a() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXZ.b() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssXZ.mu()</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;), YZ(&quot;</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         &lt;&lt; dssYZ.a() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssYZ.b() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dssYZ.mu()</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;         <span class="comment">//trace.info() &lt;&lt; ms3d &lt;&lt; std::endl;  // information</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;         </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;         Color color = cmap_hue( c );</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         <span class="keywordflow">if</span> ( tangent ) displayDSS3dTangent( viewer, ks, ms3d, color );</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;         <span class="keywordflow">if</span> ( dss3d )   displayDSS3d( viewer, ks, ms3d, color );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         <span class="keywordflow">if</span> ( dss2d )   displayDSS2d26( viewer, ks, ms3d, color );</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         <span class="keywordflow">if</span> ( proj2d )  displayProj2d26( viewer, ks, ms3d, CURVE2D_COLOR );</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;         c++;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;       }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;       <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> Space, <span class="keyword">typename</span> TangentSequence &gt;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordtype">void</span> ComputeVCM ( <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; R, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; r,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                  <span class="keyword">const</span> PointIterator &amp; begin, <span class="keyword">const</span> PointIterator &amp; end, TangentSequence &amp; tangents, <span class="keyword">const</span> std::string &amp; output )</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespaceDGtal.html">DGtal</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keyword">typedef</span> ExactPredicateLpSeparableMetric &lt; Space, 2 &gt; Metric; <span class="comment">// L2-metric</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keyword">typedef</span> VoronoiCovarianceMeasure &lt; Space, Metric &gt; VCM;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keyword">typedef</span> HyperRectDomain &lt; Space &gt; Domain;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keyword">typedef</span> functors::HatPointFunction &lt; typename Space::Point, double &gt; KernelFunction;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keyword">typedef</span> EigenDecomposition &lt; 3, double &gt; LinearAlgebraTool;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keyword">typedef</span> LinearAlgebraTool::Matrix Matrix;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  fstream outputStream;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  outputStream.open ( ( output + <span class="stringliteral">&quot;.vcm&quot;</span> ).c_str(), std::ios::out );</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  outputStream &lt;&lt; <span class="stringliteral">&quot;# VCM estimation R=&quot;</span> &lt;&lt; R &lt;&lt; <span class="stringliteral">&quot; r=&quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; chi=hat&quot;</span> &lt;&lt; endl; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  Metric l2;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  VCM vcm ( R, ceil( r ), l2, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  vcm.init( begin, end );</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  KernelFunction chi( 1.0, r );</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  Matrix vcm_r, evec;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keyword">typename</span> Space::RealVector eval;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">for</span> ( PointIterator it = begin; it != end; ++it )</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// Compute VCM and diagonalize it.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    vcm_r = vcm.measure( chi, *it );</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    LinearAlgebraTool::getEigenDecomposition ( vcm_r, evec, eval );</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keyword">typename</span> Space::RealVector tangent = evec.column( 0 );</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    tangents.push_back ( tangent );</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    outputStream &lt;&lt; (*it)[0]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*it)[1]   &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*it)[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    &lt;&lt; tangent[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tangent[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tangent[2] &lt;&lt; endl;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  outputStream.close();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> Space, <span class="keyword">typename</span> TangentSequence &gt;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordtype">void</span> ComputeLMST6 ( <span class="keyword">const</span> PointIterator &amp; begin, <span class="keyword">const</span> PointIterator &amp; end, TangentSequence &amp; tangents, <span class="keyword">const</span> std::string &amp; output  )</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;{</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> PointIterator::value_type Point;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keyword">typedef</span> StandardDSS6Computer&lt;PointIterator,int, 4 &gt; SegmentComputer;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keyword">typedef</span> SaturatedSegmentation&lt;SegmentComputer&gt; Decomposition;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::SegmentComputerIterator SegmentComputerIterator;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  SegmentComputer algo;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  Decomposition theDecomposition ( begin, end, algo );</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  fstream outputStream;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  outputStream.open ( ( output + <span class="stringliteral">&quot;.lmst&quot;</span> ).c_str(), std::ios::out );</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  outputStream &lt;&lt; <span class="stringliteral">&quot;X Y Z X Y Z&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  LambdaMST3D &lt; Decomposition &gt; lmst64;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  lmst64.attach ( theDecomposition );</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  lmst64.init ( begin, end );</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  lmst64.eval ( begin, end, std::back_inserter ( tangents ) );</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keyword">typename</span> TangentSequence::iterator itt = tangents.begin();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">for</span> ( PointIterator it = begin; it != end; ++it, ++itt )</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keyword">typename</span> Space::RealVector &amp; tangent = (*itt);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">if</span> ( tangent.norm() != 0. )</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      tangent = tangent.getNormalized();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    outputStream &lt;&lt; (*it)[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*it)[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*it)[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    &lt;&lt; tangent[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tangent[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tangent[2] &lt;&lt; endl;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> Space, <span class="keyword">typename</span> TangentSequence &gt;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordtype">void</span> ComputeLMST26 ( <span class="keyword">const</span> PointIterator &amp; begin, <span class="keyword">const</span> PointIterator &amp; end, TangentSequence &amp; tangents, <span class="keyword">const</span> std::string &amp; output  )</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;{</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> PointIterator::value_type Point;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keyword">typedef</span> Naive3DDSSComputer&lt;PointIterator,int, 8 &gt; SegmentComputer;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keyword">typedef</span> SaturatedSegmentation&lt;SegmentComputer&gt; Decomposition;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> Decomposition::SegmentComputerIterator SegmentComputerIterator;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d ArithmeticalDSSComputer2d;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  SegmentComputer algo;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  Decomposition theDecomposition ( begin, end, algo );</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  fstream outputStream;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  outputStream.open ( ( output + <span class="stringliteral">&quot;.lmst&quot;</span> ).c_str(), std::ios::out );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  outputStream &lt;&lt; <span class="stringliteral">&quot;X Y Z X Y Z&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  LambdaMST3D &lt; Decomposition &gt; lmst64;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  lmst64.attach ( theDecomposition );</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  lmst64.init ( begin, end );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  lmst64.eval ( begin, end, std::back_inserter ( tangents ) );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keyword">typename</span> TangentSequence::iterator itt = tangents.begin();</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">for</span> ( PointIterator it = begin; it != end; ++it, ++itt )</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keyword">typename</span> Space::RealVector &amp; tangent = (*itt);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> ( tangent.norm() != 0. )</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      tangent = tangent.getNormalized();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    outputStream &lt;&lt; (*it)[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*it)[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*it)[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    &lt;&lt; tangent[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tangent[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tangent[2] &lt;&lt; endl;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> Space, <span class="keywordtype">int</span> CONNECT = 8  &gt;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordtype">void</span> find_main_axes ( PointIterator begin, PointIterator end, multimap &lt; typename Space::Point, string &gt; &amp; axes )</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keyword">typedef</span> Naive3DDSSComputer &lt; PointIterator, int, CONNECT &gt; SegmentComputer;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keyword">typedef</span> SaturatedSegmentation &lt; SegmentComputer &gt; Segmentation;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    Segmentation segmenter ( begin, end, SegmentComputer ( ) );</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">for</span> ( <span class="keyword">auto</span> it = begin; it != end; ++it )</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cX = 0, cY = 0, cZ = 0;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">for</span> ( <span class="keyword">typename</span> Segmentation::SegmentComputerIterator idss = segmenter.begin ( ); idss != segmenter.end ( ); ++idss )</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="keywordflow">if</span> ( idss-&gt;isInDSS ( *it ) )</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keyword">const</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d &amp; dssXY = (*idss).arithmeticalDSS2dXY();</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keyword">const</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d &amp; dssXZ = (*idss).arithmeticalDSS2dXZ();</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="keyword">const</span> <span class="keyword">typename</span> SegmentComputer::ArithmeticalDSSComputer2d &amp; dssYZ = (*idss).arithmeticalDSS2dYZ();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lenXY = distance ( dssXY.begin(), dssXY.end() );</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lenXZ = distance ( dssXZ.begin(), dssXZ.end() );</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lenYZ = distance ( dssYZ.begin(), dssYZ.end() );</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <span class="keywordflow">if</span> ( lenXY &gt;= lenYZ &amp;&amp; lenXZ &gt;= lenYZ )</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    cX++;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( lenXY &gt;= lenXZ &amp;&amp; lenYZ &gt;= lenXZ )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    cY++;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    cZ++;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> ( cX &gt; 0 )</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          axes.insert (  pair &lt;typename Space::Point, string &gt; ( *it, <span class="keywordtype">string</span> ( <span class="stringliteral">&quot;X&quot;</span> ) ) );</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span> ( cY &gt; 0 )</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          axes.insert (  pair &lt;typename Space::Point, string &gt; ( *it, <span class="keywordtype">string</span> ( <span class="stringliteral">&quot;Y&quot;</span> ) ) );</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">if</span> ( cZ &gt; 0 )</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          axes.insert (  pair &lt;typename Space::Point, string &gt; ( *it, <span class="keywordtype">string</span> ( <span class="stringliteral">&quot;Z&quot;</span> ) ) );</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;}</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">typename</span> Po<span class="keywordtype">int</span>Iterator, <span class="keyword">typename</span> Space &gt;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="keywordtype">void</span> print_main_axes ( PointIterator begin, PointIterator end, multimap &lt; typename Space::Point, string &gt; &amp; axes )</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;{</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">for</span> ( PointIterator itt = begin; itt != end; ++itt )</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keyword">typename</span> std::multimap&lt;typename Space::Point, string&gt;::const_iterator it = axes.lower_bound(*itt);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keyword">typename</span> std::multimap&lt;typename Space::Point, string&gt;::const_iterator it2 = axes.upper_bound(*itt);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; it-&gt;first[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; it-&gt;first[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; it-&gt;first[2] &lt;&lt; <span class="stringliteral">&quot;); MAIN_AXES = (&quot;</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">for</span> (; it != it2; it++ )</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="keywordflow">if</span> ( distance( it, it2 ) &gt; 1 )</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                cout &lt;&lt; it-&gt;second &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                cout &lt;&lt; it-&gt;second &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;}</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespaceDGtal.html">DGtal</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keyword">typedef</span> SpaceND&lt;3,int&gt;                         Z3;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keyword">typedef</span> KhalimskySpaceND&lt;3,int&gt;                K3;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keyword">typedef</span> Z3::Point                              Point;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keyword">typedef</span> Z3::RealPoint                          RealPoint;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keyword">typedef</span> Z3::RealVector                         RealVector;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keyword">typedef</span> HyperRectDomain&lt;Z3&gt;                    Domain;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> vector&lt;Point&gt;::const_iterator PointIterator;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// specify command line ----------------------------------------------</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  QApplication application(argc,argv); <span class="comment">// remove Qt arguments.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// parse command line using CLI ----------------------------------------------</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  CLI::App app;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  std::string inputFileName;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  std::string viewFlag {<span class="stringliteral">&quot;OFF&quot;</span>};</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  std::string viewBox {<span class="stringliteral">&quot;WIRED&quot;</span>};</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  std::string connectivity {<span class="stringliteral">&quot;6&quot;</span>};</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  std::string method {<span class="stringliteral">&quot;VCM&quot;</span>};</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  std::string axesFlag {<span class="stringliteral">&quot;OFF&quot;</span>};</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  std::string outputFileName {<span class="stringliteral">&quot;3d-curve-tangent-estimations&quot;</span>};</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordtype">bool</span> curve3d {<span class="keyword">false</span>};</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordtype">bool</span> curve2d {<span class="keyword">false</span>};</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordtype">bool</span> cover3d {<span class="keyword">false</span>};</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordtype">bool</span> cover2d {<span class="keyword">false</span>};</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordtype">bool</span> displayTangent {<span class="keyword">false</span>};</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordtype">double</span> bigRad {10.0};</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordtype">double</span> smallRad {3.0};</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordtype">int</span> box {0};</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nbColors {3};</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  app.description(<span class="stringliteral">&quot;This program estimates the tangent vector to a set of 3D integer points, which are supposed to approximate a 3D curve. This set of points is given as a list of points in file &lt;input&gt;.\n The tangent estimator uses either the digital Voronoi Covariance Measure (VCM) or the 3D lambda-Maximal Segment Tangent (L-MST).\n This program can also displays the curve and tangent estimations, and it can also extract maximal digital straight segments (2D and 3D).\n Note: It is not compulsory for the points to be ordered in sequence, except if you wish to compute maximal digital straight segments. In this case, you can select the connectivity of your curve between 6 (standard) or 26 (naive).\n Example:\n 3dCurveTangentEstimator -i ${DGtal}/examples/samples/sinus.dat -V ON -c -R 20 -r 3 -T 6\n&quot;</span> );</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  app.add_option(<span class="stringliteral">&quot;-i,--input,1&quot;</span>, inputFileName, <span class="stringliteral">&quot;the name of the text file containing the list of 3D points: (x y z) per line.&quot;</span> )</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  -&gt;required()</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  -&gt;check(CLI::ExistingFile);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  app.add_option(<span class="stringliteral">&quot;--view,-V&quot;</span>, viewFlag, <span class="stringliteral">&quot;toggles display ON/OFF&quot;</span>,<span class="keyword">true</span> );</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  app.add_option(<span class="stringliteral">&quot;--box,-b&quot;</span>, box, <span class="stringliteral">&quot;specifies  the tightness of the bounding box around the curve with a given integer displacement &lt;arg&gt; to enlarge it (0 is tight)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  app.add_option(<span class="stringliteral">&quot;--viewBox,-v&quot;</span>, viewBox, <span class="stringliteral">&quot;displays the bounding box, &lt;arg&gt;=WIRED means that only edges are displayed, &lt;arg&gt;=COLORED adds colors for planes (XY is red, XZ green, YZ, blue).&quot;</span>, <span class="keyword">true</span>)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   -&gt; check(CLI::IsMember({<span class="stringliteral">&quot;WIRED&quot;</span> , <span class="stringliteral">&quot;COLORED&quot;</span>}));</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  app.add_option(<span class="stringliteral">&quot;--connectivity,-T&quot;</span>,connectivity, <span class="stringliteral">&quot;specifies whether it is a 6-connected curve or a 26-connected curve: arg=6 | 26.&quot;</span>, <span class="keyword">true</span> )</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   -&gt; check(CLI::IsMember({<span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;26&quot;</span>}));</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  app.add_flag(<span class="stringliteral">&quot;--curve3d,-C&quot;</span>, curve3d, <span class="stringliteral">&quot;displays the 3D curve&quot;</span> );</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  app.add_flag(<span class="stringliteral">&quot;--curve2d,-c&quot;</span>, curve2d, <span class="stringliteral">&quot;displays the 2D projections of the 3D curve on the bounding box&quot;</span> );</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  app.add_flag(<span class="stringliteral">&quot;--cover3d,-3&quot;</span>, cover3d, <span class="stringliteral">&quot;displays the 3D tangential cover of the curve&quot;</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  app.add_flag(<span class="stringliteral">&quot;--cover2d,-2&quot;</span>, cover2d, <span class="stringliteral">&quot;displays the 2D projections of the 3D tangential cover of the curve&quot;</span>);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  app.add_flag(<span class="stringliteral">&quot;--tangent,-t&quot;</span>, displayTangent, <span class="stringliteral">&quot;displays the tangents to the curve.&quot;</span>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  app.add_option(<span class="stringliteral">&quot;--nbColors,-n&quot;</span>, nbColors, <span class="stringliteral">&quot;sets the number of successive colors used for displaying 2d and 3d maximal segments (default is 3: red, green, blue)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  app.add_option(<span class="stringliteral">&quot;--big-radius,-R&quot;</span>,bigRad, <span class="stringliteral">&quot;the radius parameter R in the VCM estimator.&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  app.add_option(<span class="stringliteral">&quot;--small-radius,-r&quot;</span>,smallRad, <span class="stringliteral">&quot;the radius parameter r in the VCM estimator.&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  app.add_option(<span class="stringliteral">&quot;--method,-m&quot;</span>, method, <span class="stringliteral">&quot;the method of tangent computation: VCM (default), L-MST.&quot;</span>, <span class="keyword">true</span>)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   -&gt; check(CLI::IsMember({<span class="stringliteral">&quot;VCM&quot;</span>, <span class="stringliteral">&quot;L-MST&quot;</span>}));</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  app.add_option(<span class="stringliteral">&quot;--axes,-a&quot;</span>, axesFlag, <span class="stringliteral">&quot;show main axes - prints list of axes for each point and color points color = (if X =&gt; 255, if Y =&gt; 255, if Z =&gt; 255)&quot;</span>, <span class="keyword">true</span>)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   -&gt; check(CLI::IsMember({<span class="stringliteral">&quot;ON&quot;</span>,<span class="stringliteral">&quot;OFF&quot;</span>}));</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  app.add_option(<span class="stringliteral">&quot;--output,-o&quot;</span>,outputFileName, <span class="stringliteral">&quot;the basename of the output text file which will contain points and tangent vectors: (x y z tx ty tz) per line&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  app.get_formatter()-&gt;column_width(40);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  CLI11_PARSE(app, argc, argv);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// END parse command line using CLI ----------------------------------------------</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// process command line ----------------------------------------------</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  vector&lt;Point&gt; sequence;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  fstream inputStream;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  inputStream.open ( inputFileName.c_str(), ios::in);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">try</span> </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    sequence = PointListReader&lt;Point&gt;::getPointsFromInputStream( inputStream );</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">if</span> ( sequence.size() == 0) <span class="keywordflow">throw</span> IOException();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">catch</span> (DGtal::IOException &amp; ioe) </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    trace.error() &lt;&lt; <span class="stringliteral">&quot;Size is null.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  inputStream.close();</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">// start viewer</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordtype">bool</span> view = viewFlag == <span class="stringliteral">&quot;ON&quot;</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">// axes</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">bool</span> axes = axesFlag == <span class="stringliteral">&quot;ON&quot;</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  multimap &lt; Z3i::Point, string &gt; mainAxes;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> ( axes &amp;&amp; connectivity == <span class="stringliteral">&quot;26&quot;</span> )</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      find_main_axes&lt;PointIterator, Z3i::Space&gt;(sequence.begin(), sequence.end(), mainAxes);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      print_main_axes&lt;PointIterator, Z3i::Space&gt;(sequence.begin(), sequence.end(), mainAxes);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( axes &amp;&amp; connectivity == <span class="stringliteral">&quot;6&quot;</span> )</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    find_main_axes &lt; PointIterator, Z3i::Space, 4 &gt; ( sequence.begin ( ), sequence.end ( ), mainAxes );</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    print_main_axes&lt;PointIterator, Z3i::Space&gt;(sequence.begin(), sequence.end(), mainAxes);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// ----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">// Create domain and curve.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  Point lowerBound = sequence[ 0 ];</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  Point upperBound = sequence[ 0 ];</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 1; j &lt; sequence.size(); ++j )</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    lowerBound = lowerBound.inf( sequence[ j ] );</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    upperBound = upperBound.sup( sequence[ j ] );</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  lowerBound -= Point::diagonal( box );</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  upperBound += Point::diagonal( box + 1 );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  K3 ks; ks.init( lowerBound, upperBound, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  Viewer3D&lt;Z3,K3&gt; viewer( ks );</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  trace.beginBlock ( <span class="stringliteral">&quot;Tool 3dCurveTangentEstimator&quot;</span> );</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  std::vector&lt; RealVector &gt; tangents;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">if</span> ( method == <span class="stringliteral">&quot;VCM&quot;</span> )</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// input points of the curve are in sequence vector.</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> R = bigRad;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    trace.info() &lt;&lt; <span class="stringliteral">&quot;Big radius   R = &quot;</span> &lt;&lt; R &lt;&lt; endl;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> r = smallRad;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    trace.info() &lt;&lt; <span class="stringliteral">&quot;Small radius r = &quot;</span> &lt;&lt; r &lt;&lt; endl;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    ComputeVCM &lt; PointIterator, Z3, std::vector&lt; RealVector &gt; &gt; ( R, r, sequence.begin(), sequence.end(), tangents, outputFileName );</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( method == <span class="stringliteral">&quot;L-MST&quot;</span> )</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (connectivity == <span class="stringliteral">&quot;6&quot;</span>)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      ComputeLMST6  &lt; PointIterator, Z3, std::vector&lt; RealVector &gt; &gt; ( sequence.begin(), sequence.end(), tangents, outputFileName );</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      ComputeLMST26  &lt; PointIterator, Z3, std::vector&lt; RealVector &gt; &gt; ( sequence.begin(), sequence.end(), tangents, outputFileName );</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    trace.info() &lt;&lt; <span class="stringliteral">&quot;Wrong method! Try: VCM or L-MST&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    abort();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> ( view ) </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; tangents.size(); i++ )</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="comment">// Display normal</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      RealPoint p = sequence[i]; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      RealVector tangent = tangents[i]; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      viewer.setFillColor( Color ( 255, 0, 0, 255 ) );</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      viewer.setLineColor( Color ( 255, 0, 0, 255 ) );</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      viewer.addLine( p + 2.0 * tangent, p - 2.0 * tangent,  5.0 );</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      viewer.setFillColor( Color ( 100, 100, 140, 255 ) );</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      viewer.setLineColor( Color ( 100, 100, 140, 255 ) );</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      viewer.addBall( p, 0.125, 8 );</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  GridCurve&lt;K3&gt; gc( ks );</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">try</span> </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    gc.initFromPointsVector( sequence );</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  } </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordflow">catch</span> (DGtal::ConnectivityException&amp; <span class="comment">/*ce*/</span>) </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    trace.warning() &lt;&lt; <span class="stringliteral">&quot;[ConnectivityException] GridCurve only accepts a sequence of face adjacent points. Try connectivity=6 instead.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// ----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// Displays everything.</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordtype">bool</span> res = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">if</span> ( view )</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    viewer.show();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// Display axes.</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> ( viewBox != <span class="stringliteral">&quot;&quot;</span> )</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      displayAxes&lt;Point,RealPoint, Z3i::Space, Z3i::KSpace&gt;( viewer, lowerBound, upperBound, viewBox );</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// Display 3D tangential cover.</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    res = connectivity == <span class="stringliteral">&quot;6&quot;</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    ? displayCover6( viewer, ks, sequence.begin(), sequence.end(),</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                     cover3d,</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                     curve2d,</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                     cover2d,</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                     displayTangent,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                     nbColors )</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    : displayCover26( viewer, ks, sequence.begin(), sequence.end(),</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                      cover3d,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                      curve2d,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                      cover2d,</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                      displayTangent,</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                      nbColors );</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// Display 3D curve points.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> ( curve3d &amp;&amp; ! axes )</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      viewer &lt;&lt; CustomColors3D( CURVE3D_COLOR, CURVE3D_COLOR );</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">for</span> ( vector&lt;Point&gt;::const_iterator it = sequence.begin(); it != sequence.end(); ++it )</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;           viewer &lt;&lt; *it;  </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( curve3d &amp;&amp; axes )</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">for</span> ( vector&lt;Point&gt;::const_iterator itt = sequence.begin(); itt != sequence.end(); ++itt ) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keyword">typename</span> std::multimap&lt;typename Z3i::Point, string&gt;::const_iterator it = mainAxes.lower_bound(*itt);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="keyword">typename</span> std::multimap&lt;typename Z3i::Point, string&gt;::const_iterator it2 = mainAxes.upper_bound(*itt);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            Z3i::Point pColor;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordflow">for</span> (; it != it2; it++ )</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <span class="keywordflow">if</span> (it-&gt;second == <span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    pColor[0] = 255;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">if</span> (it-&gt;second == <span class="stringliteral">&quot;Y&quot;</span>)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    pColor[1] = 255;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keywordflow">if</span> (it-&gt;second == <span class="stringliteral">&quot;Z&quot;</span>)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    pColor[2] = 255;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            Color c ( pColor[0], pColor[1], pColor[2], 255 );</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            viewer.setFillColor(c);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            viewer &lt;&lt; *itt;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// ----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">// User &quot;interaction&quot;.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    viewer &lt;&lt; Viewer3D&lt;Z3,K3&gt;::updateDisplay;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    application.exec();</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  trace.emphase() &lt;&lt; ( res ? <span class="stringliteral">&quot;Passed.&quot;</span> : <span class="stringliteral">&quot;Error.&quot;</span> ) &lt;&lt; endl;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  trace.endBlock();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">return</span> res ? 0 : 1;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;}</div>
<div class="ttc" id="anamespaceDGtal_html"><div class="ttname"><a href="namespaceDGtal.html">DGtal</a></div><div class="ttdef"><b>Definition:</b> <a href="ATu0v1_8h_source.html#l00056">ATu0v1.h:57</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Companion project associated to  <a href= "http://liris.cnrs.fr/dgtal/doc/nightly/"> DGtal </a>;
    Generated on Wed Jun 2 2021 15:34:51 for DGtalTools by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
</html>
