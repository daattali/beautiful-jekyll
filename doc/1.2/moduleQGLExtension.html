<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGtal: Extending the QGLViewer Viewer3D interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-blue.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Extending the QGLViewer <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a> interface </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#QGLExtension_sec1">Extending the standard behavior of Viewer3D</a></li>
<li class="level1"><a href="#QGLExtension_sec2">Activating your extension in some viewer</a></li>
</ul>
</div>
<div class="textblock"><p>This part of the manual describes how to extend the standard <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a> interface of <a class="el" href="namespaceDGtal.html" title="DGtal is the top-level namespace which contains all DGtal functions and types.">DGtal</a>. For instance, you wish to assign new handlers keys or to mouse event, or you wish to display or select other graphical elements. To do that, you just have to write a class that derived from <a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html">Viewer3D::Extension</a> and overrides some methods to get your desired behaviour.</p>
<dl class="section author"><dt>Author</dt><dd>Jacques-Olivier Lachaud</dd></dl>
<dl class="section since"><dt>Since</dt><dd>9.4</dd></dl>
<p>Related examples: <a class="el" href="viewer3D-11-extension_8cpp_source.html">viewer3D-11-extension.cpp</a></p>
<p>Related modules: <a class="el" href="moduleQGLInteraction.html">Limited interaction when using selection with QGLViewer Viewer3D stream mechanism</a></p>
<h1><a class="anchor" id="QGLExtension_sec1"></a>
Extending the standard behavior of Viewer3D</h1>
<p>The <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a> interface provides a very handy way of visualising 3D scenes, digital objects or meshes in <a class="el" href="namespaceDGtal.html" title="DGtal is the top-level namespace which contains all DGtal functions and types.">DGtal</a>, and is bundled with many functionalities (like moving the light, selecting some objects, etc). However it is not directly extensible as is, and, for several reasons, you cannot derive from the <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a> class directly to add some new functionalities.</p>
<p>Therefore we provide the class <a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html">Viewer3D::Extension</a> so that you can extend the viewer in several ways. The principle is very easy. This interface provides a set of empty virtual methods so you just have to override them in order to change the behavior of the viewer. For instance, you just have to override <a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#aea194e2540b7b7ad4e8f96da8bf76b5d">Viewer3D::Extension::keyPressEvent</a> to capture other key events. You can override all the following methods:</p>
<ul>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#aea194e2540b7b7ad4e8f96da8bf76b5d">Viewer3D::Extension::keyPressEvent</a>. This method may be overloaded to capture other key events.</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a8c697a5d411f5c1f8d720c6eafc4c779">Viewer3D::Extension::drawWithNames</a>. This method is useful for drawing elements with additional information for selection (see also <a class="el" href="moduleQGLInteraction.html">Limited interaction when using selection with QGLViewer Viewer3D stream mechanism</a>).</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a5a8f4662c864d9120c85e5c5040a2d0a">Viewer3D::Extension::draw</a>. This method is useful for drawing elements that are not directly handled by <a class="el" href="classDGtal_1_1Viewer3D.html">Viewer3D</a>.</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#aa74435380ac4c98fc172f1665cd6bdcf">Viewer3D::Extension::init</a>. This method is useful at initialization (e.g. adding lights manipulators).</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a52c86b89a1da667ee3ac5868bb33a549">Viewer3D::Extension::helpString</a>. This method is useful to change the help message.</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a838786675cc685bfc53102f2f9287c6c">Viewer3D::Extension::postSelection</a>. This method is useful to take care of mouse selection events.</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a148dae829b6779d975403fe8899736ac">Viewer3D::Extension::mouseMoveEvent</a>. This method is useful to take care of mouse movements.</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a76b181513277dbff85b529c2bbb785b7">Viewer3D::Extension::mousePressEvent</a>. This method is useful to take care of mouse button press events.</li>
<li><a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html#a6653dba610df74eb5abc9aa72499e825">Viewer3D::Extension::mouseReleaseEvent</a>. This method is useful to take care of mouse button release events.</li>
</ul>
<p>The example below shows how to capture "Shift+R" key pressed events, so that each time this event occurs random points are added to the 3D scene.</p>
<div class="fragment"><div class="line"><span class="comment">// Deriving from Viewer3D::Extension to add new callbacks to events.</span></div>
<div class="line"><span class="keyword">struct </span>RandomPointKeyExtension : <span class="keyword">public</span> Viewer3D&lt;Space, KSpace&gt;::Extension</div>
<div class="line">{</div>
<div class="line">  RandomPointKeyExtension()</div>
<div class="line">  {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Here we override the &quot;key pressed&quot; event, and a point randomly in</span></div>
<div class="line">  <span class="comment">// the scene if the key &quot;Shift+R&quot; is pressed.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> keyPressEvent( <a class="code" href="classDGtal_1_1Viewer3D.html">Viewer</a> &amp; viewer, QKeyEvent * event )</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordtype">bool</span> handled = <span class="keyword">false</span>;</div>
<div class="line">    <span class="comment">// Get event modifiers key</span></div>
<div class="line">    <span class="keyword">const</span> Qt::KeyboardModifiers modifiers = <span class="keyword">event</span>-&gt;modifiers();</div>
<div class="line">    <span class="keywordflow">if</span> ( ( event-&gt;key() == Qt::Key_R ) &amp;&amp; ( modifiers == Qt::ShiftModifier ) )</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a> p = viewer.<a class="code" href="classDGtal_1_1Display3D.html#ab4678f961136a23573def5d6cfe29aa4">space</a>().lowerBound();</div>
<div class="line">      <a class="code" href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a> q = viewer.<a class="code" href="classDGtal_1_1Display3D.html#ab4678f961136a23573def5d6cfe29aa4">space</a>().upperBound();</div>
<div class="line">      <a class="code" href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a> d = q - p;</div>
<div class="line">      <a class="code" href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a> a( ( rand() % d[ 0 ] ) + p[ 0 ], ( rand() % d[ 1 ] ) + p[ 1 ],</div>
<div class="line">               ( rand() % d[ 2 ] ) + p[ 2 ] );</div>
<div class="line">      viewer &lt;&lt; a;</div>
<div class="line">      viewer &lt;&lt; <a class="code" href="classDGtal_1_1Display3D.html#a96b45e0a0c762c14c0e5e27045d1ca04a96910329360ab83c484f03e0fff1cb45">Viewer::updateDisplay</a>;</div>
<div class="line">      <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;Adding point &quot;</span> &lt;&lt; a &lt;&lt; std::endl;</div>
<div class="line">      handled = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> handled;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// We also override the Viewer3D::init method to add a key</span></div>
<div class="line">  <span class="comment">// description in the help window.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="testCubicalComplex_8cpp.html#a2ab29adfd8ee31956627f4230b96a34b">init</a>( <a class="code" href="classDGtal_1_1Viewer3D.html">Viewer</a> &amp; viewer )</div>
<div class="line">  {</div>
<div class="line">    viewer.setKeyDescription( Qt::ShiftModifier + Qt::Key_R,</div>
<div class="line">                              <span class="stringliteral">&quot;Creates a random digital point.&quot;</span> );</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// We also override the Viewer3D::helpString method to add a</span></div>
<div class="line">  <span class="comment">// description to the viewer.</span></div>
<div class="line">  <span class="keyword">virtual</span> QString helpString( <span class="keyword">const</span> <a class="code" href="classDGtal_1_1Viewer3D.html">Viewer</a> &amp; <span class="comment">/*viewer*/</span> )<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    QString text( <span class="stringliteral">&quot;&lt;h2&gt; Random point Viewer3D &lt;/h2&gt;&quot;</span> );</div>
<div class="line">    text += <span class="stringliteral">&quot;Press Shift+R to add points.&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> text;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="aclassDGtal_1_1Display3D_html_a96b45e0a0c762c14c0e5e27045d1ca04a96910329360ab83c484f03e0fff1cb45"><div class="ttname"><a href="classDGtal_1_1Display3D.html#a96b45e0a0c762c14c0e5e27045d1ca04a96910329360ab83c484f03e0fff1cb45">DGtal::Display3D&lt; SpaceND&lt; 3 &gt;, KhalimskySpaceND&lt; 3 &gt; &gt;::updateDisplay</a></div><div class="ttdeci">@ updateDisplay</div><div class="ttdef"><b>Definition:</b> <a href="Display3D_8h_source.html#l00249">Display3D.h:249</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Display3D_html_ab4678f961136a23573def5d6cfe29aa4"><div class="ttname"><a href="classDGtal_1_1Display3D.html#ab4678f961136a23573def5d6cfe29aa4">DGtal::Display3D::space</a></div><div class="ttdeci">const KSpace &amp; space() const</div><div class="ttdef"><b>Definition:</b> <a href="Display3D_8h_source.html#l00340">Display3D.h:340</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Trace_html_ad054990834d2763627166540087a2980"><div class="ttname"><a href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">DGtal::Trace::info</a></div><div class="ttdeci">std::ostream &amp; info()</div></div>
<div class="ttc" id="aclassDGtal_1_1Viewer3D_html"><div class="ttname"><a href="classDGtal_1_1Viewer3D.html">DGtal::Viewer3D</a></div><div class="ttdef"><b>Definition:</b> <a href="Viewer3D_8h_source.html#l00135">Viewer3D.h:136</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_a8fc7012708b0416880a5c8b12dfdf9dd"><div class="ttname"><a href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">DGtal::trace</a></div><div class="ttdeci">Trace trace</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00154">Common.h:154</a></div></div>
<div class="ttc" id="atestClone2_8cpp_html_a15e9592ccc512dc691b46185e6814758"><div class="ttname"><a href="testClone2_8cpp.html#a15e9592ccc512dc691b46185e6814758">Point</a></div><div class="ttdeci">MyPointD Point</div><div class="ttdef"><b>Definition:</b> <a href="testClone2_8cpp_source.html#l00383">testClone2.cpp:383</a></div></div>
<div class="ttc" id="atestCubicalComplex_8cpp_html_a2ab29adfd8ee31956627f4230b96a34b"><div class="ttname"><a href="testCubicalComplex_8cpp.html#a2ab29adfd8ee31956627f4230b96a34b">init</a></div><div class="ttdeci">K init(Point(0, 0, 0), Point(512, 512, 512), true)</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="QGLExtension_sec2"></a>
Activating your extension in some viewer</h1>
<p>Once you have built a class that derives from <a class="el" href="structDGtal_1_1Viewer3D_1_1Extension.html">Viewer3D::Extension</a>, it remains to create some instance of this extension and to hand it to your viewer. This is done by the following lines.</p>
<div class="fragment"><div class="line">  MyViewer viewer( <a class="code" href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a> );</div>
<div class="line">  viewer.<a class="code" href="classDGtal_1_1Viewer3D.html#a26923741d6377f421a456cd237890c3f">setExtension</a>( <span class="keyword">new</span> RandomPointKeyExtension );</div>
<div class="ttc" id="aclassDGtal_1_1Viewer3D_html_a26923741d6377f421a456cd237890c3f"><div class="ttname"><a href="classDGtal_1_1Viewer3D.html#a26923741d6377f421a456cd237890c3f">DGtal::Viewer3D::setExtension</a></div><div class="ttdeci">void setExtension(Extension *ext)</div><div class="ttdef"><b>Definition:</b> <a href="Viewer3D_8h_source.html#l00316">Viewer3D.h:316</a></div></div>
<div class="ttc" id="atestCubicalComplex_8cpp_html_a2b87ed989d2519d025bd5d4fbcbac062"><div class="ttname"><a href="testCubicalComplex_8cpp.html#a2b87ed989d2519d025bd5d4fbcbac062">K</a></div><div class="ttdeci">KSpace K</div><div class="ttdef"><b>Definition:</b> <a href="testCubicalComplex_8cpp_source.html#l00062">testCubicalComplex.cpp:62</a></div></div>
</div><!-- fragment --><p> The viewer will take care of freeing your instanciated extension object. For a complete example, see <a class="el" href="viewer3D-11-extension_8cpp_source.html">viewer3D-11-extension.cpp</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 1 2021 17:06:33 for DGtal by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
