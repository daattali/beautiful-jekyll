<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGtal: Discrete exterior calculus</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-blue.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Discrete exterior calculus </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sectDECIntroduction">Introduction</a><ul><li class="level2"><a href="#sectDECStruture">DEC geometrical structure</a></li>
<li class="level2"><a href="#sectDECIntroductionObjects">Scalar field, k-form and vector field</a></li>
<li class="level2"><a href="#sectDECOperators">Discrete linear operators</a><ul><li class="level3"><a href="#sectDECOperatorHodge">Hodge duality operator</a></li>
<li class="level3"><a href="#sectDECOperatorDerivative">Exterior derivative</a></li>
<li class="level3"><a href="#sectDECOperatorAntiderivative">Antiderivative</a></li>
<li class="level3"><a href="#sectDECoperatorMusical">Sharp and flat</a></li>
<li class="level3"><a href="#sectDECOperatorClassical">Classical vector analysis</a></li>
<li class="level3"><a href="#sectDECOperatorLaplace">Laplace operators</a></li>
</ul>
</li>
<li class="level2"><a href="#sectDECLinearProblem">DEC linear problem</a></li>
<li class="level2"><a href="#sectDECIntroductionFurther">Further reading</a></li>
</ul>
</li>
<li class="level1"><a href="#sectDECHandsOn">Hands on the DEC package</a><ul><li class="level2"><a href="#sectDECIntroduction3">Main DEC object creation</a></li>
<li class="level2"><a href="#sectDECIntroduction4">KForm and VectorField manipulation</a></li>
<li class="level2"><a href="#sectDECLinearSolver">DEC linear solver</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>Author(s) of this documentation: </dt><dd>Pierre Gueth</dd></dl>
<h1><a class="anchor" id="sectDECIntroduction"></a>
Introduction</h1>
<p>Discrete Exterior Calculus (DEC) provides a nice way to represent discrete scalar and vector fields, as well as linear vector analysis operators. It can be potentially applied to a large number of field theory problem, such as electrodynamics, thermodynamics or really any linear physics problem.</p>
<p>DEC extends efficiently continuous Riemannian geometry vector fields and differential forms to the discrete world. Discretization of differential forms induces a natural discretization of linear operators between them. This allows easy and fast resolution of linear problem over complex geometric objects.</p>
<h2><a class="anchor" id="sectDECStruture"></a>
DEC geometrical structure</h2>
<p>A DEC structure is composed of a primal and a dual k-cells sets which define the geometrical shape of the represented object. These sets are interleaved and are the dual of each others in the classical sense. Each pair of primal and dual k-cells holds primal and dual sizes used to define the Hodge duality operator. Associated primal k-cell and dual k'-cell don't have the same dimension. In general, \(k&#39; = n - k\) where \(n\) is the dimension of the DEC structure.</p>
<dl class="section note"><dt>Note</dt><dd>By definition 0-cell must have a primal size equals to 1 and n-cell must have dual size equals to 1.</dd></dl>
<p><a class="anchor" id="one"></a></p><div class="image">
<img src="grille_cubique.png" alt=""/>
<div class="caption">
Primal (solid lines and filled dots) and dual (dashed lines and hollow dots) k-cells sets defining a 3D DEC structure.</div></div>
<h2><a class="anchor" id="sectDECIntroductionObjects"></a>
Scalar field, k-form and vector field</h2>
<p>DEC scalar field associate a scalar value to each 0-cells of the structure. DEC vector field associate an n dimensional quantity (a arrow for example) to each 0-cells of the structure.</p>
<p>DEC k differential forms, or k-forms for short, associate a scalar value to each primal or dual k-cells of the structure. They are the discrete extension of continuous differential forms defined in tensor calculus and Riemannian geometry to the discrete world. It important to remember that they can be used to transform k-vector into scalar fields and therefore form a base of k-vectors tangent bundles. Following this definition, the first example of k-forms are scalar fields, which are analogous to 0-forms. Discrete 1-forms, as their continuous counter part, can be constructed from vector fields to created "project along this vector field" operator. 1-forms are therefore linked to vector field and the DEC provides flat and sharp operators to transform one into the other. Higher order differential forms can be constructed from 0- and 1-forms through using wedge product to form complex structure such as metric tensor (n-form) or any other tensorial quantity.</p>
<p>Vector fields and k-forms come in both primal and dual flavors. Choosing duality has a small geometrical influence since primal and dual cells are slightly shifted, but most importantly this choice changes boundary conditions when solving linear DEC problem. See <a class="el" href="moduleDECPoisson.html#sectDECPoisson1D">1D Poisson resolution</a> for an example.</p>
<p>Moreover k-forms and vector fields forms vector space as long as their duality and order is preserved. Two compatible fields or differential forms can therefore be added, subtracted or scaled through external multiplication.</p>
<p>Finally, it is important to note that non empty k-forms space exists only for \( 0 \leq k \leq n \). Knowing that base k-forms can be constructed for k 1-forms wedged together, it can be easily proven that if \( k &gt; n \) the base vanishes due the antisymmetric nature of wedge product and the limited choice of linearly independent 1-forms. K-forms are represented using <a class="el" href="classDGtal_1_1KForm.html" title="Aim: KForm represents discrete kforms in the dec package.">KForm</a> class. Vector fields are represented using the <a class="el" href="classDGtal_1_1VectorField.html" title="Aim: VectorField represents a discrete vector field in the dec package. Vector field values are attac...">VectorField</a> class.</p>
<h2><a class="anchor" id="sectDECOperators"></a>
Discrete linear operators</h2>
<p>Discretization of k-forms induces a discretization of linear operators between k-forms. An important statement of DEC is that any of those operators can be expressed easily using only two basic operations, Hodge duality operators \(\star\) and exterior derivative \(d\). Since k-forms vector spaces are in finite number, those operators are also in finite number. DEC defines two more operators : \(\sharp\) (sharp) transforms 1-forms into vector fields and \(\flat\) (flat) transforms vector fields into 1-forms. The following figure shows all available linear operators for a 3D structure, where TM (resp. TM') represents the primal (resp. dual) tangent bundle, the union of all tangent vector spaces generated by primal (resp. dual) vector fields. K-cells associated with k-forms are highlighted in red next to the k-form spaces. As for DEC objects, operators come also in both primal and dual flavor. Dual stuff have a prime and primal stuff stay pristine. Linear operators between k-forms are represented by <a class="el" href="classDGtal_1_1LinearOperator.html" title="Aim: LinearOperator represents discrete linear operator between discrete kforms in the DEC package.">LinearOperator</a> class.</p>
<p><a class="anchor" id="two"></a></p><div class="image">
<img src="operators_3d.png" alt=""/>
<div class="caption">
DEC operators with definition cells for a 3D rectangular grid.</div></div>
<h3><a class="anchor" id="sectDECOperatorHodge"></a>
Hodge duality operator</h3>
<p>Intuitively, one can think of Hodge duality operator as orthogonal complement operators on k-cells. Wedging any k-cells with its orthogonal complement always forms the volume form (single n-form base). They take care of size ratio and orientation change between primal and dual meshes. \(\star_k\) (resp. \(\star_k&#39;\)) take primal (resp. dual) k-forms as input and create dual (resp. primal) (n-k)-forms. Hodge operators are defined by their action on a value of a discrete k-form \(x\) at a k-cell \(\sigma\).</p>
<p class="formulaDsp">
\[ \star x ( \star\sigma ) = \frac{|\star\sigma|}{|\sigma|} x ( \sigma )\]
</p>
<p>where \(|\sigma|\) is the size of \(\sigma\). Applying \(\star\) twice to a k-form \(x\) will give \(x\) back up to sign given by the following equation.</p>
<p class="formulaDsp">
\[ \star \star x = -1^{(n-k)k} x \]
</p>
<p>Most of the time applying \(\star\) twice is the same as applying an identity operator. The first two Hodge operators switch k-form sign is for \(n=2\) and \(k=1\) : taking twice the orthogonal of edge in a 2D structure result in a sign flip of the corresponding 1-form. From the equation above, one can show that 4 \(\star\) always contract to identity.</p>
<p class="formulaDsp">
\[ \star \star \star \star x = x \]
</p>
<p>Primal Hodge operators \(\star_k\) and dual Hodge operators \(\star_k&#39;\)) are generated using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#abeb4ba6563c8654e5c3649dcc226887a">DiscreteExteriorCalculus.hodge</a> with k as the first template parameter and duality as the second template parameter. See <a href="https://en.wikipedia.org/wiki/Hodge_dual">wikipedia page</a> for more details.</p>
<h3><a class="anchor" id="sectDECOperatorDerivative"></a>
Exterior derivative</h3>
<p>Exterior derivative operators are the second kind of basic operator on which DEC is built. Exterior derivatives take k-forms as inputs and create (k+1)-forms. Input and output forms keep the same duality. As all derivative operators, \(d\) follow the Leibniz rule for derivative of a product of k-forms.</p>
<p class="formulaDsp">
\[ d ( x \wedge y ) = d x \wedge y + (-1)^k x \wedge d y \]
</p>
<p>where x is a k-form and y is a k'-form with the same duality. Applying any exterior derivative twice always vanishes.</p>
<p class="formulaDsp">
\[ d d x = 0 \]
</p>
<p>This rules out many buildable complex linear operators as one has to switch duality every time a derivative is applied. In the DEC package, exterior derivative operators are generated using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a67f137b97f6762a5cb1804c761aa08fe">DiscreteExteriorCalculus.derivative</a> with input k-form order as the first template parameter and duality as the second template parameter. See <a href="https://en.wikipedia.org/wiki/Exterior_derivative">wikipedia page</a> for more details.</p>
<h3><a class="anchor" id="sectDECOperatorAntiderivative"></a>
Antiderivative</h3>
<p>Antiderivative operators are shorthand operators that appear in many DEC problems. They take k-forms as inputs and create (k-1)-forms. Input and output forms keep the same duality. Here is the definition of \(\delta\), the antiderivative acting on k-forms.</p>
<p class="formulaDsp">
\[ \delta = \star&#39; d&#39; \star \]
</p>
<p>In the DEC package, antiderivative operators are generated using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a064604eb776b33fac53b566a525b60ac">DiscreteExteriorCalculus.antiderivative</a>. As for \(d\), applying any antiderivative twice vanishes.</p>
<p class="formulaDsp">
\[ \delta \delta x = 0 \]
</p>
<h3><a class="anchor" id="sectDECoperatorMusical"></a>
Sharp and flat</h3>
<p>Sharp \(\sharp\) and flat \(\flat\), called <em>musical isomorphisms</em> in <a class="el" href="citelist.html#CITEREF_goes2013digital">[38]</a>, transform 1-form into vector field and the other way around. In the continuous world, these two operators cancel each other exactly.</p>
<p class="formulaDsp">
\[ (x ^\sharp) ^\flat = x \]
</p>
 <p class="formulaDsp">
\[ (y ^\flat) ^\sharp = y \]
</p>
<p>where \(x\) is a 1-form and \(y\) is a vector field of the same duality. The bijectivity of these operators is slightly altered by the discretization. Therefore application of sharp and flat will induce a small divergence from the origin. This is especially visible along borders of the structure. Contrary to Hodge operators and exterior derivative, sharp and flat operators don't exist as stand alone object, but rather get applied by the DEC structure directly through <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a6c1dc3521122f1a83905f162fdb20df9">DiscreteExteriorCalculus.sharp</a> and <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a36498d8bde9fe0a71a53ecb42caaa615">DiscreteExteriorCalculus.flat</a>.</p>
<h3><a class="anchor" id="sectDECOperatorClassical"></a>
Classical vector analysis</h3>
<p>Classical vector analysis operators such as gradient \(\nabla\), divergence \(\nabla\cdot\), curl \(\nabla\wedge\) and Laplace operator \(\Delta\) can be expressed with basic DEC operators, \(\star\), \(d\), \(\sharp\) and \(\flat\).</p>
<p class="formulaDsp">
\[\nabla x = ( d x )^\sharp \]
</p>
<p class="formulaDsp">
\[\nabla\cdot x = \star d \star x^\flat = \delta x \]
</p>
<p class="formulaDsp">
\[\nabla\wedge x = ( \star d x^\flat )^\sharp \]
</p>
<p class="formulaDsp">
\[\Delta x = \star d \star d x = \delta d x \]
</p>
<p>Note that each basic operators changes with the dimension of the structure \(n\) and duality of the input k-form vector space.</p>
<h3><a class="anchor" id="sectDECOperatorLaplace"></a>
Laplace operators</h3>
<p>In order to find the right operators to use, one could draw a figure similar to Figure <a class="el" href="moduleDECIntroduction.html#two">two</a>. Using this figure together with the definition of vector analysis operators provided in the above section, the order and duality of each operator become easy to figure out. For example, one can easily figure out the precise definition of the primal Laplace operator \(\Delta\) and the dual Laplace operator \(\Delta&#39;\) in 3D dimension. Paths taken by those operators are highlighted in Figure <a class="el" href="moduleDECIntroduction.html#three">three</a>. \(\Delta\) can be expressed using derivative and antiderivative.</p>
<p class="formulaDsp">
\[ \Delta = \star_3&#39; d_2&#39; \star_1 d_0 = \delta_1 d_0 \]
</p>
<p class="formulaDsp">
\[ \Delta&#39; = \star_3 d_2 \star_1&#39; d_0&#39;= \delta_1&#39; d_0&#39; \]
</p>
<p><a class="anchor" id="three"></a></p><div class="image">
<img src="operators_3d_laplace.png" alt=""/>
<div class="caption">
DEC operators with definition cells for a rectangular grid. Highlighted primal Laplace operator (green), dual Laplace operator (blue) together with its constituting basic DEC operators (red).</div></div>
<p>If the dimension of the DEC structure changes, the definition of the primal Laplace operator changes slightly. For example, here is the definition of the primal Laplace operator in 2D. Note that the expression using antiderivative do not change.</p>
<p class="formulaDsp">
\[ \Delta = \star_2&#39; d_1&#39; \star_1 d_0 = \delta_1 d_0 \]
</p>
<p>Note that <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> provides <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a424b75e14a8fb0aa7010736e60c360e0">DiscreteExteriorCalculus.laplace</a> to conveniently compute Laplace operators. Of course, one could still built Laplace operator of basic Hodge and derivative (see <a class="el" href="moduleDECHelmoltz.html#sectDECHelmoltz2D">2D Helmoltz decomposition</a>).</p>
<h2><a class="anchor" id="sectDECLinearProblem"></a>
DEC linear problem</h2>
<p>Using the DEC package, one can solve any equation of the type:</p>
<p class="formulaDsp">
\[ f(x) = y \]
</p>
<p>where \(x\) and \(y\) are k-forms, with potentially different orders and dualities, and \(f\) is a linear operator between k-forms. One can create linear operators by manually filling <a class="el" href="classDGtal_1_1LinearOperator.html#aa5696bafeed5f62de870b35ef6b9dad8">LinearOperator.myContainer</a>, but it's often easier to combine derivative \(d\) and duality operators \(\star\) computed by <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a67f137b97f6762a5cb1804c761aa08fe">DiscreteExteriorCalculus.derivative</a> and <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#abeb4ba6563c8654e5c3649dcc226887a">DiscreteExteriorCalculus.hodge</a>.</p>
<p>Recall that \(\flat\) and \(\sharp\) are operators that turn a vector field into a 1-form and the other way around. Those operators are linear but do not transform k-forms into k-forms and therefore can't be represented by <a class="el" href="classDGtal_1_1LinearOperator.html" title="Aim: LinearOperator represents discrete linear operator between discrete kforms in the DEC package.">LinearOperator</a>. However <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> allows us to apply those transformations on associated k-forms and vector fields, namely <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a36498d8bde9fe0a71a53ecb42caaa615">DiscreteExteriorCalculus.flat</a> and <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a6c1dc3521122f1a83905f162fdb20df9">DiscreteExteriorCalculus.sharp</a>. These operators are cached in the <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> object and support intense load, as Hodge and derivative operators do. We chose to disable \(\flat\) and \(\sharp\) representation because the quantity of information stored in the associated 1-form is always bigger than the quantity of information stored in the vector field.</p>
<h2><a class="anchor" id="sectDECIntroductionFurther"></a>
Further reading</h2>
<ul>
<li>Keenan Crane SIGGRAPH lecture 2013 "Geometry processing using DEC" <a href="https://github.com/dgpdec/course">github repository</a> <a class="el" href="citelist.html#CITEREF_goes2013digital">[38]</a></li>
<li>Mathieu Desbrun article on discrete exterior calculus <a class="el" href="citelist.html#CITEREF_desbrun2005discrete">[42]</a></li>
<li>Digital foam presentation with an introduction to DEC in the second section <a href="http://sd-33294.dedibox.fr/~pierre/presentation_dec.pdf">pdf</a></li>
</ul>
<h1><a class="anchor" id="sectDECHandsOn"></a>
Hands on the DEC package</h1>
<p>This section provides an overview on structures and classes that compose the DEC package. All snippets are taken from <a class="el" href="exampleDiscreteExteriorCalculusUsage_8cpp_source.html">exampleDiscreteExteriorCalculusUsage.cpp</a>. Here is a typical list of headers needed to use the DEC package.</p>
<div class="fragment"><div class="line"><span class="comment">// always include EigenSupport.h before any other Eigen headers</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/math/linalg/EigenSupport.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/dec/DiscreteExteriorCalculus.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/dec/DiscreteExteriorCalculusSolver.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/dec/DiscreteExteriorCalculusFactory.h&quot;</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="sectDECIntroduction3"></a>
Main DEC object creation</h2>
<p>In this package, the main DEC object is <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a>. The first template parameter is the dimension of the embedded structure one wants to represent. The second template parameter is the dimension of the ambient space in which the structure in embedded. For obvious reasons, the ambient dimension must be equal or greater than the embedded dimension. The ambient dimension is used internally by <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a922e280223318bf3d66e79a875055002">DiscreteExteriorCalculus.myKSpace</a> and therefore is the maximum dimension of cells and points used to fill the DEC object. The third template parameter is a linear algebra backend used internally to specify containers and solvers. By now, there is only one available backend: <a class="el" href="structDGtal_1_1EigenLinearAlgebraBackend.html" title="Aim: Provide linear algebra backend using Eigen dense and sparse matrix as well as dense vector....">EigenLinearAlgebraBackend</a>. For example, here is a snippet that define a working two dimensional DEC object embedded in a two dimensional ambient space along with the corresponding factory type.</p>
<div class="fragment"><div class="line">    <span class="keyword">typedef</span> DiscreteExteriorCalculus&lt;2, 2, EigenLinearAlgebraBackend&gt; Calculus;</div>
<div class="line">    <span class="keyword">typedef</span> DiscreteExteriorCalculusFactory&lt;EigenLinearAlgebraBackend&gt; CalculusFactory;</div>
</div><!-- fragment --><p> The <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> provides a default constructor that initializes an empty structure, ready to be filled with <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a3847b77d16aef735e8bd41d1af99b04e">DiscreteExteriorCalculus::SCell</a> through the <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8e3c021b594f326a72ed4485b1aa7ea3">DiscreteExteriorCalculus.insertSCell</a> member. <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> objects can also be created using the <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusFactory.html" title="Aim: This class provides static members to create DEC structures from various other DGtal structures.">DiscreteExteriorCalculusFactory</a> factory. <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusFactory.html#a0f0410c21d66a8c7ef951321e52bf587">DiscreteExteriorCalculusFactory::createFromDigitalSet</a> static member inserts each point of a digital set as a primal n-cell in the structure and then fills in-between k-cells to glue all n-cells together. <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusFactory.html#ac290b55c774d9fa9e6ac9c1baa150b50">DiscreteExteriorCalculusFactory::createFromNSCells</a> static member creates embedded structures. See <a class="el" href="moduleDECEmbedding.html">Embedding n-dimensional DEC structures into m-dimensional space</a> for a discussion about manifold embedding. Borders can be added or removed from the generated structure using the add_border boolean to enforce various boundary condition. Dual k-cells are created automatically. Note that the structure can be altered after creation to adjust small details or created completely manually via calls to <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8e3c021b594f326a72ed4485b1aa7ea3">DiscreteExteriorCalculus.insertSCell</a> and <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8a16a4f15194fbd08f0b569b44ab4b41">DiscreteExteriorCalculus.eraseCell</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Internal indexes should be reset by calling <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a0875e7462461a50cbb68339071882740">DiscreteExteriorCalculus.updateIndexes</a> after <b>any</b> call to <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8e3c021b594f326a72ed4485b1aa7ea3">DiscreteExteriorCalculus.insertSCell</a> or <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8a16a4f15194fbd08f0b569b44ab4b41">DiscreteExteriorCalculus.eraseCell</a> and <b>before</b> doing anything else with the structure. This includes instanciation of any <a class="el" href="classDGtal_1_1KForm.html" title="Aim: KForm represents discrete kforms in the dec package.">KForm</a>, <a class="el" href="classDGtal_1_1VectorField.html" title="Aim: VectorField represents a discrete vector field in the dec package. Vector field values are attac...">VectorField</a> or <a class="el" href="classDGtal_1_1LinearOperator.html" title="Aim: LinearOperator represents discrete linear operator between discrete kforms in the DEC package.">LinearOperator</a> as well as any type of output and size computation. <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> created by <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusFactory.html" title="Aim: This class provides static members to create DEC structures from various other DGtal structures.">DiscreteExteriorCalculusFactory</a> have valid indexes and can be used as it is.</dd></dl>
<p>This snippet shows how to create a DEC structure. The first call to <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8a16a4f15194fbd08f0b569b44ab4b41">DiscreteExteriorCalculus.eraseCell</a> removes the primal n-cell located of the right of the structure. The associated dual 0-cell is destroyed automatically. Note that n-cells are created using <a class="el" href="classDGtal_1_1KhalimskySpaceND.html#a7d5231f241513f15be0a1ee092db2590" title="From the digital coordinates of a point in Zn, builds the corresponding spel (cell of maximal dimensi...">KhalimskySpaceND.sSpel</a>, and that coordinates of such cells are given in the same system as points from the input set. The second call removes a primal 1-cell and opens the hole created by the first call. Here coordinates are given in the <a class="el" href="classDGtal_1_1KhalimskySpaceND.html" title="Aim: This class is a model of CCellularGridSpaceND. It represents the cubical grid as a cell complex,...">KhalimskySpaceND</a> signed cell frame of reference. To finalize the structure, a call to <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a0875e7462461a50cbb68339071882740">DiscreteExteriorCalculus.updateIndexes</a> is performed.</p>
<div class="fragment"><div class="line">    Calculus calculus = CalculusFactory::createFromDigitalSet(generateRingSet(<a class="code" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>), <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    calculus.eraseCell(calculus.myKSpace.uSpel(<a class="code" href="namespaceDGtal_1_1Z2i.html#ac0a04516c81db6f4a583eddda0f64875">Z2i::Point</a>(8, 5)));</div>
<div class="line">    calculus.eraseCell(calculus.myKSpace.uCell(<a class="code" href="namespaceDGtal_1_1Z2i.html#ac0a04516c81db6f4a583eddda0f64875">Z2i::Point</a>(18, 11)));</div>
<div class="line"> </div>
<div class="line">    calculus.updateIndexes();</div>
<div class="ttc" id="anamespaceDGtal_1_1Z2i_html_ac0a04516c81db6f4a583eddda0f64875"><div class="ttname"><a href="namespaceDGtal_1_1Z2i.html#ac0a04516c81db6f4a583eddda0f64875">DGtal::Z2i::Point</a></div><div class="ttdeci">Space::Point Point</div><div class="ttdef"><b>Definition:</b> <a href="StdDefs_8h_source.html#l00095">StdDefs.h:95</a></div></div>
<div class="ttc" id="atestProjection_8cpp_html_a1f1a69f8d8b037b72c2160ed12b3ef51"><div class="ttname"><a href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a></div><div class="ttdeci">Domain domain</div><div class="ttdef"><b>Definition:</b> <a href="testProjection_8cpp_source.html#l00088">testProjection.cpp:88</a></div></div>
</div><!-- fragment --><p> Note moreover that in DEC, <b>positive</b> 1-cells are oriented is the <b>opposite</b> direction of increasing coordinates.</p>
<div class="image">
<img src="usage_calculus_with_border.png" alt=""/>
<div class="caption">
Calculus with border.</div></div>
<p>If you want to have border-less structure, simply reset the add_border boolean. See <a class="el" href="moduleDECEmbedding.html#sectDECBorderDefinition">Border definition</a> for a discussion about border definition. The second call to <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8a16a4f15194fbd08f0b569b44ab4b41">DiscreteExteriorCalculus.eraseCell</a> isn't needed anymore since the edge was not inserted in the first place.</p>
<div class="fragment"><div class="line">    Calculus calculus = CalculusFactory::createFromDigitalSet(generateRingSet(<a class="code" href="testProjection_8cpp.html#a1f1a69f8d8b037b72c2160ed12b3ef51">domain</a>), <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    calculus.eraseCell(calculus.myKSpace.uSpel(<a class="code" href="namespaceDGtal_1_1Z2i.html#ac0a04516c81db6f4a583eddda0f64875">Z2i::Point</a>(8, 5)));</div>
<div class="line"> </div>
<div class="line">    calculus.updateIndexes();</div>
</div><!-- fragment --><div class="image">
<img src="usage_calculus_without_border.png" alt=""/>
<div class="caption">
Calculus without border.</div></div>
<p>Sometime one doesn't want to create DEC structure from higher order cells using the set factory of <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusFactory.html">DiscreteExteriorCalculusFactory</a>. It is possible to insert cells manually into the DEC structure using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a8e3c021b594f326a72ed4485b1aa7ea3">DiscreteExteriorCalculus.insertSCell</a>. Inserting a new cell invalidate all previously created k-forms, linear operators and vector fields. Therefore the DEC structure shouldn't be modified once DEC operators are created.</p>
<h2><a class="anchor" id="sectDECIntroduction4"></a>
KForm and VectorField manipulation</h2>
<p>K-forms are represented by the <a class="el" href="classDGtal_1_1KForm.html" title="Aim: KForm represents discrete kforms in the dec package.">KForm</a> templated class and vector field are represented by the <a class="el" href="classDGtal_1_1VectorField.html" title="Aim: VectorField represents a discrete vector field in the dec package. Vector field values are attac...">VectorField</a> templated class. Note that <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a> provides handy typedef of common k-forms and vector field, such as <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a93139e8d35019c8edeed41a4beb21cc6">DiscreteExteriorCalculus::PrimalForm0</a>, <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a7b0fdce92ad2444aad7014fb362fd82d">DiscreteExteriorCalculus::DualForm2</a>, <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#afe6524b41e6c4aff575b3e2de440a6cf">DiscreteExteriorCalculus::PrimalVectorField</a> and <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#ace4e6442cca56661799f2dcd64345a6d">DiscreteExteriorCalculus::DualVectorField</a>. Once a k-form is created, its actual values can by accessed through <a class="el" href="classDGtal_1_1KForm.html#a19e859f462f1d851550465b7fcc2c68d">KForm.myContainer</a>. Cell indexes can be retrieved from cells using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a60d5c4790f28ac28d8b595de9002e44d">DiscreteExteriorCalculus.getSCell</a> and cell can be retrieved from cells using <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#a60d5c4790f28ac28d8b595de9002e44d">DiscreteExteriorCalculus.getSCell</a>.</p>
<p>Convenience members <a class="el" href="classDGtal_1_1KForm.html#a1cc70af046b3d7be85f8f49121a56d39">KForm.length</a>, <a class="el" href="classDGtal_1_1VectorField.html#a41d23b8dc915244c696d2d53d121b83d">VectorField.length</a>, <a class="el" href="classDGtal_1_1KForm.html#acbbda0e8b98473c552b3dd12aa6a8853">KForm.getSCell</a> and <a class="el" href="classDGtal_1_1VectorField.html#ab4bdaa2b59b29f2c467c1e25ca31e888">VectorField.getSCell</a> can be used to traverse structures easily. Here is a example snippet that compute a Euclidean distance map (scalar field) on the structure defined above.</p>
<div class="fragment"><div class="line">        Calculus::PrimalForm0 primal_zero_form(calculus);</div>
<div class="line">        <span class="keywordflow">for</span> (Calculus::Index index=0; index&lt;primal_zero_form.length(); index++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> Calculus::SCell&amp; cell = primal_zero_form.getSCell(index);</div>
<div class="line">            <span class="keyword">const</span> Calculus::Scalar&amp; value = <a class="code" href="namespaceDGtal_1_1Z2i.html#afa16730fe413692cdb474b45d4fff388">Z2i::l2Metric</a>(calculus.myKSpace.sKCoords(cell), center)/2;</div>
<div class="line">            primal_zero_form.myContainer(index) = value;</div>
<div class="line">        }</div>
<div class="ttc" id="anamespaceDGtal_1_1Z2i_html_afa16730fe413692cdb474b45d4fff388"><div class="ttname"><a href="namespaceDGtal_1_1Z2i.html#afa16730fe413692cdb474b45d4fff388">DGtal::Z2i::l2Metric</a></div><div class="ttdeci">static const L2Metric l2Metric</div><div class="ttdef"><b>Definition:</b> <a href="StdDefs_8h_source.html#l00123">StdDefs.h:123</a></div></div>
</div><!-- fragment --><div class="image">
<img src="usage_primal_zero_form.png" alt=""/>
<div class="caption">
Primal 0-form.</div></div>
<p>K-forms, as vector field, can be scaled, added and subtracted using standard cpp operators.</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> Calculus::PrimalForm0 foo = 2 * primal_zero_form + primal_zero_form;</div>
</div><!-- fragment --><p> In the snippet, we compute the primal gradient of the previous scalar field using formula from <a class="el" href="moduleDECIntroduction.html#sectDECOperatorClassical">Classical vector analysis</a>. Convenience linear operator <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html#afa5ee348ea8634877e8098d28cd0d4cd">DiscreteExteriorCalculus::DualDerivative0</a> is used.</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> Calculus::PrimalDerivative0 primal_zero_derivative = calculus.derivative&lt;0, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">        <span class="keyword">const</span> Calculus::PrimalForm1 primal_one_form = primal_zero_derivative * primal_zero_form;</div>
<div class="line">        <span class="keyword">const</span> Calculus::PrimalVectorField primal_vector_field = calculus.sharp(primal_one_form);</div>
<div class="ttc" id="anamespaceDGtal_html_ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7"><div class="ttname"><a href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">DGtal::PRIMAL</a></div><div class="ttdeci">@ PRIMAL</div><div class="ttdef"><b>Definition:</b> <a href="Duality_8h_source.html#l00061">Duality.h:61</a></div></div>
</div><!-- fragment --><div class="image">
<img src="usage_primal_one_form.png" alt=""/>
<div class="caption">
Gradient primal 1-form and primal vector field.</div></div>
<p>Flat and sharp operators are applied to test the property presented in <a class="el" href="moduleDECIntroduction.html#sectDECoperatorMusical">Sharp and flat</a>. Original vector field and its dual sharped version differ slightly along the border of the structure. See bottom right part on the inner hole for example.</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> Calculus::PrimalForm1 flat_sharp_primal_one_form = calculus.flat(primal_vector_field);</div>
<div class="line">        <span class="keyword">const</span> Calculus::PrimalVectorField sharp_flat_primal_vector_field = calculus.sharp(flat_sharp_primal_one_form);</div>
</div><!-- fragment --><div class="image">
<img src="usage_primal_one_form_sharp_flat.png" alt=""/>
<div class="caption">
Flat sharped primal gradient vector field.</div></div>
<p>The orthogonality of the Hodge operator is demonstrated here, as we compute the dual of the gradient vector field described above. One can see that primal of dual vector fields are always locally orthogonal everywhere.</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> Calculus::PrimalHodge1 primal_one_hodge = calculus.hodge&lt;1, <a class="code" href="namespaceDGtal.html#ab8007ddbb5627666913e18c3b951745da7b7d86a1d82efbe8b9bc0ad3c7c80bd7">PRIMAL</a>&gt;();</div>
<div class="line">        <span class="keyword">const</span> Calculus::DualForm1 dual_one_form = primal_one_hodge * primal_zero_derivative * primal_zero_form;</div>
<div class="line">        <span class="keyword">const</span> Calculus::DualVectorField dual_vector_field = calculus.sharp(dual_one_form);</div>
</div><!-- fragment --><div class="image">
<img src="usage_primal_one_form_hodge.png" alt=""/>
<div class="caption">
Primal vector fields and its dual.</div></div>
<h2><a class="anchor" id="sectDECLinearSolver"></a>
DEC linear solver</h2>
<p>If your problem can be described as a <a class="el" href="moduleDECIntroduction.html#sectDECLinearProblem">DEC linear problem</a>, <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html" title="Aim: This wraps a linear algebra solver around a discrete exterior calculus.">DiscreteExteriorCalculusSolver</a> can be used to solve it.</p>
<p>The solving method used is provided as the second template parameter of <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html" title="Aim: This wraps a linear algebra solver around a discrete exterior calculus.">DiscreteExteriorCalculusSolver</a>. It depends on the linear algebra backend you pass as second template argument in the definition of <a class="el" href="classDGtal_1_1DiscreteExteriorCalculus.html" title="Aim: DiscreteExteriorCalculus represents a calculus in the dec package. This is the main structure in...">DiscreteExteriorCalculus</a>. Usually some linear solvers are provided in the linear algebra backend itself, but you can create your own as long as it models the CLinearAlgebraSolver concept.</p>
<p>If you activated Eigen support during compilation (i.e. "-DWITH_EIGEN=true"), you can use any solver provided in the <a class="el" href="EigenSupport_8h_source.html">EigenSupport.h</a> header. It is recommended to use the <a class="el" href="structDGtal_1_1EigenLinearAlgebraBackend.html" title="Aim: Provide linear algebra backend using Eigen dense and sparse matrix as well as dense vector....">EigenLinearAlgebraBackend</a> since it is fast and provide a lot of linear solvers.</p>
<p>Once the DEC solver is created, the linear operator \(f\) must be passed via <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a90f2a9e43a13293e6368b63298363b60">DiscreteExteriorCalculusSolver.compute</a>. Depending on the linear solver used, this will factorize the problem or do precomputation on the linear operator. This speed up the resolution of problems that share the same linear operator. Input k-form \(y\) is passed to the solver via <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a7673281a29a04ef2978bad9b373c2382">DiscreteExteriorCalculusSolver.solve</a> which return the solution k-form \(x\). If the resolution was successful, then <a class="el" href="classDGtal_1_1DiscreteExteriorCalculusSolver.html#a073f1c0cdb349421b1a6d499fefc6052">DiscreteExteriorCalculusSolver.isValid</a> will return true. If there was a problem, it can be further investigated by direct access to the linear algebra solver DiscreteExteriorCalculusSolver.solver.</p>
<p>Choosing the right solver for the right problem has a direct impact on overall performances. The <a class="el" href="structDGtal_1_1EigenLinearAlgebraBackend.html" title="Aim: Provide linear algebra backend using Eigen dense and sparse matrix as well as dense vector....">EigenLinearAlgebraBackend</a> provide wrapper for all linear algebra solvers included in the Eigen library. This <a href="http://eigen.tuxfamily.org/dox/group__TopicSparseSystems.html">documentation page</a> provides a nice summary of wrappable solvers along with their main traits.</p>
<p>Resolution of <a class="el" href="moduleDECPoisson.html#sectDECPoissonProblem">Poisson equation</a> and <a class="el" href="moduleDECHelmoltz.html#sectDECHelmoltzProblem">Helmoltz decomposition</a> are provided as example. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 1 2021 17:06:23 for DGtal by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
