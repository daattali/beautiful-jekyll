<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>DGtal: Tutorial &quot;Generated shape -&gt; Grid curve -&gt; Length estimation&quot;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-blue.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">0.9.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial "Generated shape -&gt; Grid curve -&gt; Length estimation" </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#secttutoShapeGridCurveEstimator0">Implicit Gauss digitization of a Euclidean shape</a></li>
<li class="level1"><a href="#secttutoShapeGridCurveEstimator1">Tracking, grid curve, range</a></li>
<li class="level1"><a href="#secttutoShapeGridCurveEstimator2">Length estimation</a></li>
<li class="level1"><a href="#secttutoShapeGridCurveEstimator3">Increasing the resolution</a></li>
<li class="level1"><a href="#secttutoShapeGridCurveEstimator5">Length estimator comparison</a></li>
<li class="level1"><a href="#secttutoShapeGridCurveEstimator4">Required includes</a></li>
</ul>
</div>
<div class="textblock"><dl class="section user"><dt>Author(s) of this documentation:</dt><dd>Tristan Roussillon</dd></dl>
<p>In this example, we show how to test a length estimator of the contour of a generated shape, which is digitized at different resolutions.</p>
<h1><a class="anchor" id="secttutoShapeGridCurveEstimator0"></a>
Implicit Gauss digitization of a Euclidean shape</h1>
<p>Let us assume that a flower-like shape has been instanciated. We now implicitely consider its digitization according to the Gauss scheme (set of digital points lying inside the shape).</p>
<div class="fragment"><div class="line">  <span class="comment">//implicit digitization of a shape of type Flower </span></div>
<div class="line">  <span class="comment">//into a digital space of type Space</span></div>
<div class="line">  <span class="keywordtype">double</span> h = 1; </div>
<div class="line">  GaussDigitizer&lt;Z2i::Space,Flower&gt; dig;  </div>
<div class="line">  dig.attach( flower );</div>
<div class="line">  dig.init( flower.getLowerBound()+<a class="code" href="namespaceDGtal_1_1Z2i.html#a7622ca076fc84589070b3a7719f0eb1e">Z2i::Vector</a>(-1,-1),</div>
<div class="line">            flower.getUpperBound()+<a class="code" href="namespaceDGtal_1_1Z2i.html#a7622ca076fc84589070b3a7719f0eb1e">Z2i::Vector</a>(1,1), h ); </div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Similarly to the previous tutorial (<a class="el" href="tutoImageGridCurveEstimator.html">Tutorial "Image -&gt; Region -&gt; Grid curve -&gt; Length estimation"</a>), the explicit construction of the digital set is not necessary. Since the shape knows its bounding domain, it is enough to have a predicate that indicates, for each point of the domain, whether it belongs to the digital set or not. This is a useful feature when we want to digitize a shape at a high resolution.</dd>
<dd>
The grid step <em>h</em> is given in the init method of the <a class="el" href="classDGtal_1_1GaussDigitizer.html" title="Aim: A class for computing the Gauss digitization of some Euclidean shape, i.e. its intersection with...">GaussDigitizer</a>. The smaller the grid step, the higher the resolution is.</dd></dl>
<h1><a class="anchor" id="secttutoShapeGridCurveEstimator1"></a>
Tracking, grid curve, range</h1>
<p>The extraction of the contour is performed in a cellular space (with 0-, 1-, and 2-cells), given an adjacency (0-, 1-, 2-adjacency). See <a class="el" href="moduleCellularTopology.html">Cellular grid space and topology, unoriented and oriented cells, incidence</a> for the basic concepts of cellular topology.</p>
<div class="fragment"><div class="line">  <span class="comment">//Khalimsky space</span></div>
<div class="line">  <a class="code" href="namespaceDGtal_1_1Z2i.html#a6183d00ec6f8c4f81748fd20a52e5590">Z2i::KSpace</a> ks;</div>
<div class="line">  ks.init( dig.getLowerBound(), dig.getUpperBound(), true );</div>
<div class="line">  <span class="comment">//adjacency (4-connectivity)</span></div>
<div class="line">  SurfelAdjacency&lt;2&gt; sAdj( <span class="keyword">true</span> );</div>
</div><!-- fragment --><p> Since there is only one connected digital set, a fast method is used to find a first boundary element (i.e. a 1-cell between a 2-cell inside the shape and a 2-cell outside the shape). Instead of scanning the whole domain, points are randomly tested, until one point inside the shape and one point outside the shape are found. A dichotomic process is then used to retrieve the boundary element that is lying between these two points.</p>
<dl class="section note"><dt>Note</dt><dd>A <a class="el" href="classDGtal_1_1InputException.html">DGtal::InputException</a> is raised if the method fails to find two different points.</dd></dl>
<p>From one boundary 1-cell, the contour is then implicitely tracked as follows:</p>
<div class="fragment"><div class="line">  <span class="comment">//searching for one boundary element</span></div>
<div class="line">  <a class="code" href="namespaceDGtal_1_1Z2i.html#ada8961626acc7fab62a96bf22bc74281">Z2i::SCell</a> bel = <a class="code" href="classDGtal_1_1Surfaces.html#a48e3a0e7c4728f6a6f23ec6f468a41b8">Surfaces&lt;Z2i::KSpace&gt;::findABel</a>( ks, dig, 1000 );</div>
<div class="line">  <span class="comment">//tracking</span></div>
<div class="line">  std::vector&lt;Z2i::Point&gt; boundaryPoints;</div>
<div class="line">  Surfaces&lt;Z2i::KSpace&gt;</div>
<div class="line">    ::track2DBoundaryPoints( boundaryPoints, ks, sAdj, dig, bel );</div>
</div><!-- fragment --><p> The <a class="el" href="classDGtal_1_1GridCurve.html" title="Aim: describes, in a cellular space of dimension n, a closed or open sequence of signed d-cells (or d...">GridCurve</a> object is merely built from the retrieved contour:</p>
<div class="fragment"><div class="line">  <a class="code" href="namespaceDGtal_1_1Z2i.html#a503faf4d34b6500e8f14035911fa04d5">Z2i::Curve</a> c;</div>
<div class="line">  c.initFromVector( boundaryPoints );  </div>
</div><!-- fragment --><p> Here is a picture of the contour:</p>
<div class="image">
<img src="Flower1.png" alt="Flower1.png"/>
<div class="caption">
Flower (h=1)</div></div>
 <h1><a class="anchor" id="secttutoShapeGridCurveEstimator2"></a>
Length estimation</h1>
<p>The DSS approach chosen below for the length estimation requires a points range:</p>
<div class="fragment"><div class="line">  <span class="comment">//range of points</span></div>
<div class="line">  <span class="keyword">typedef</span> <a class="code" href="classDGtal_1_1GridCurve.html#a765c54283ed52bdde1e46f0db4658d7f">Z2i::Curve::PointsRange</a> Range; </div>
<div class="line">  Range r = c.getPointsRange(); </div>
</div><!-- fragment --><p> Similarly to the previous tutorial (<a class="el" href="tutoImageGridCurveEstimator.html">Tutorial "Image -&gt; Region -&gt; Grid curve -&gt; Length estimation"</a>), we initialize the DSS length estimator from the points range and get the estimated length.</p>
<div class="fragment"><div class="line">  <span class="comment">//length estimation</span></div>
<div class="line">  DSSLengthEstimator&lt; Range::ConstCirculator &gt; DSSlength;</div>
<div class="line">  DSSlength.init( h, r.<a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#a672560bc711e9c3e064c0b87baf27a1d">c</a>(), r.<a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#a672560bc711e9c3e064c0b87baf27a1d">c</a>() );</div>
<div class="line">  <span class="keywordtype">double</span> length1 = DSSlength.eval();</div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;Length (h=&quot;</span> &lt;&lt; h &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; length1 &lt;&lt; std::endl; </div>
</div><!-- fragment --><p> Note that there is a specific length estimator, which is called true length estimator, because it returns the true length (or a very close value to the true length). The only difference between the true estimator and the other ones is that the true estimator knows the shape and its parameters.</p>
<div class="fragment"><div class="line">  <span class="keyword">typedef</span> ParametricShapeArcLengthFunctor&lt; Flower &gt; Length;</div>
<div class="line">  TrueGlobalEstimatorOnPoints&lt; </div>
<div class="line">    <a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#add5c504648ac126ae8f897f2064da44d">Range::ConstIterator</a>, </div>
<div class="line">    Flower, </div>
<div class="line">    Length  &gt;  trueLengthEstimator;</div>
<div class="line">  trueLengthEstimator.init( h, r.<a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#a3f3127761d5c822c16368719929eb07e">begin</a>(), r.<a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#aeff6def66f4bbd73d61afb27e3f23035">end</a>(), &amp;flower, c.isClosed());</div>
<div class="line">  <span class="keywordtype">double</span> trueLength = trueLengthEstimator.eval(); </div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;ground truth: &quot;</span> &lt;&lt; trueLength &lt;&lt; std::endl; </div>
</div><!-- fragment --><p> Thanks to the true estimator, it is very easy to compare the accuracy of the estimators against a ground truth. In our example, we have:</p>
<div class="fragment"><div class="line">Length (h=1): 163.646</div>
<div class="line">ground truth: 165.961</div>
</div><!-- fragment --><h1><a class="anchor" id="secttutoShapeGridCurveEstimator3"></a>
Increasing the resolution</h1>
<p>In order to have a better accuracy in the estimation, we digitize now the shape at a higher resolution, i.e. with a smaller grid step. We choose as grid step h=0.1 instead of h=1:</p>
<div class="fragment"><div class="line">  <span class="comment">//implicit digitization at higher resolution</span></div>
<div class="line">  h = 0.1; </div>
<div class="line">  dig.init( flower.getLowerBound()+<a class="code" href="namespaceDGtal_1_1Z2i.html#a7622ca076fc84589070b3a7719f0eb1e">Z2i::Vector</a>(-1,-1),</div>
<div class="line">            flower.getUpperBound()+<a class="code" href="namespaceDGtal_1_1Z2i.html#a7622ca076fc84589070b3a7719f0eb1e">Z2i::Vector</a>(1,1), h ); </div>
<div class="line">  <span class="comment">//a greater domain is needed in the Khalimsky space</span></div>
<div class="line">  ks.init( dig.getLowerBound(), dig.getUpperBound(), true );</div>
<div class="line">  <span class="comment">//searching for one boundary element</span></div>
<div class="line">  bel = <a class="code" href="classDGtal_1_1Surfaces.html#a48e3a0e7c4728f6a6f23ec6f468a41b8">Surfaces&lt;Z2i::KSpace&gt;::findABel</a>( ks, dig, 10000 );</div>
<div class="line">  <span class="comment">//tracking</span></div>
<div class="line">  Surfaces&lt;Z2i::KSpace&gt;</div>
<div class="line">    ::track2DBoundaryPoints( boundaryPoints, ks, sAdj, dig, bel );</div>
<div class="line">  <span class="comment">//reset grid curve and its points range</span></div>
<div class="line">  c.initFromVector( boundaryPoints );</div>
<div class="line">  Range r2 = c.getPointsRange(); </div>
<div class="line">  <span class="comment">//estimate length</span></div>
<div class="line">  DSSlength.init( h, r2.<a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#a672560bc711e9c3e064c0b87baf27a1d">c</a>(), r2.<a class="code" href="classDGtal_1_1SimpleRandomAccessRangeFromPoint.html#a672560bc711e9c3e064c0b87baf27a1d">c</a>() );</div>
<div class="line">  <span class="keywordtype">double</span> length2 = DSSlength.eval();</div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a8fc7012708b0416880a5c8b12dfdf9dd">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;Length (h=&quot;</span> &lt;&lt; h &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; length2 &lt;&lt; std::endl;  </div>
</div><!-- fragment --><p> Here is a picture of the contour:</p>
<div class="image">
<img src="Flower01.png" alt="Flower01.png"/>
<div class="caption">
Flower (h=0.1)</div></div>
 <p>At grid step 0.1, the estimation is better and close to the ground truth (165.961), since we get: </p><div class="fragment"><div class="line">Length (h=0.1): 165.94</div>
</div><!-- fragment --><h1><a class="anchor" id="secttutoShapeGridCurveEstimator5"></a>
Length estimator comparison</h1>
<p>Many other length estimators are implemented (see <a class="el" href="classDGtal_1_1L1LengthEstimator.html" title="Aim: a simple model of CGlobalCurveEstimator that compute the length of a curve using the l_1 metric ...">L1LengthEstimator</a>, <a class="el" href="classDGtal_1_1BLUELocalLengthEstimator.html" title="Aim: Best Linear Unbiased Two step length estimator. ">BLUELocalLengthEstimator</a>, <a class="el" href="classDGtal_1_1RosenProffittLocalLengthEstimator.html" title="Aim: Rosen-Proffitt Length Estimator. ">RosenProffittLocalLengthEstimator</a>, <a class="el" href="classDGtal_1_1MLPLengthEstimator.html" title="Aim: a model of CGlobalCurveEstimator that computes the length of a digital curve using its MLP (give...">MLPLengthEstimator</a>, <a class="el" href="classDGtal_1_1FPLengthEstimator.html" title="Aim: a model of CGlobalCurveEstimator that computes the length of a digital curve using its FP (faith...">FPLengthEstimator</a>). You can compare them in a multiresolution framework thanks to the nice tool lengthEstimators.cpp. It provides a way of generating a given shape (whose parameters are given as arguments) at increasing resolution and list, for each resolution, the ground truth and the length estimated by all the available methods. For instance, the data of the following plot come from this tool:</p>
<div class="image">
<img src="graphTuto4.png" alt="graphTuto4.png"/>
<div class="caption">
Perimeter of a digitized disk of radius 10</div></div>
 <h1><a class="anchor" id="secttutoShapeGridCurveEstimator4"></a>
Required includes</h1>
<p>Here are the basic includes: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;DGtal/base/Common.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/helpers/StdDefs.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ConfigExamples.h&quot;</span></div>
</div><!-- fragment --><p> In order to generate an implicite or parametric shape, you need this: </p><div class="fragment"><div class="line"><span class="comment">//shape and digitizer</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/shapes/Shapes.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/shapes/ShapeFactory.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/shapes/GaussDigitizer.h&quot;</span></div>
</div><!-- fragment --><p> To retrieve its contour, you should add: </p><div class="fragment"><div class="line"><span class="comment">//tracking grid curve</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/topology/helpers/Surfaces.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/curves/GridCurve.h&quot;</span></div>
</div><!-- fragment --><p> And finally the length estimation requires: </p><div class="fragment"><div class="line"><span class="comment">//length estimation knowing the shape</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/curves/estimation/TrueGlobalEstimatorOnPoints.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/curves/estimation/ParametricShapeArcLengthFunctor.h&quot;</span></div>
<div class="line"><span class="comment">//length estimation based on a DSS segmentation</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/curves/estimation/DSSLengthEstimator.h&quot;</span></div>
</div><!-- fragment --></div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 27 2016 09:38:26 for DGtal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
