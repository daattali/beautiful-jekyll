<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>DGtal: geometry/surfaces/greedy-plane-segmentation-ex2.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DGtal
   &#160;<span id="projectnumber">0.6.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">geometry/surfaces/greedy-plane-segmentation-ex2.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>This example shows a not-so-greedy segmentation into naive planes of the surface at threshold 0 within volume Al.100.vol.</p>
<p>It enhances the polyhedrization of <a class="el" href="greedy-plane-segmentation_8cpp_source.html">greedy-plane-segmentation.cpp</a> by selecting first the vertices that induces the biggest planes. This is much slower than the other, but it gives nicer results. For each vertex, it computes its best plane by breadth-first traversal. It stores the obtained size for each vertex independently. It puts them in a priority queue, the first to be popped are the ones with the biggest size. The remaining of the algorithm is unchanged.</p>
<p>Colors for each plane are chosen randomly. Surfels in the same plane have the same color.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="moduleNaivePlaneRecognition.html#moduleNaivePlaneRecognition_sec5">Application to greedy segmentation into digital planes</a> (solution of exercice 2)</dd></dl>
<pre class="fragment"># naive plane: width=1/1
$ ./examples/geometry/surfaces/greedy-plane-segmentation-ex2 -i ./examples/samples/Al.100.vol -t 0 -w 1 -d 1
</pre><div class="image">
<img src="greedy-plane-segmentation-ex2-al-w1.png" alt="greedy-plane-segmentation-ex2-al-w1.png"/>
<div class="caption">
Not-so-greedy segmentation of Al capone into naive planes.</div></div>
<div class="fragment"><div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/program_options/options_description.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/program_options/parsers.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/program_options/variables_map.hpp&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;QtGui/qapplication.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/base/Common.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/io/readers/VolReader.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/io/viewers/Viewer3D.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/io/Display3D.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/io/DrawWithDisplay3DModifier.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/images/ImageSelector.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/images/imagesSetsUtils/SetFromImage.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/topology/DigitalSurface.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/topology/DigitalSetBoundary.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/graph/BreadthFirstVisitor.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/geometry/surfaces/COBANaivePlane.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DGtal/helpers/StdDefs.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ConfigExamples.h&quot;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>DGtal;</div>
<div class="line"><span class="keyword">namespace </span>po = boost::program_options;</div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>Z3i;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="namespaceDGtal.html#a1c09e3f63904ff371f1b99f45069fc63" title="signed 94-bit integer.">DGtal::int64_t</a> InternalInteger;</div>
<div class="line"><span class="keyword">typedef</span> <a name="_a0"></a><a class="code" href="classDGtal_1_1COBANaivePlane.html">COBANaivePlane&lt;Z3,InternalInteger&gt;</a> <a class="code" href="classDGtal_1_1COBANaivePlane.html">NaivePlaneComputer</a>;</div>
<div class="line"><span class="comment">// We choose the DigitalSetBoundary surface container in order to</span></div>
<div class="line"><span class="comment">// segment connected or unconnected surfaces.</span></div>
<div class="line"><span class="keyword">typedef</span> <a name="_a1"></a><a class="code" href="classDGtal_1_1DigitalSetBoundary.html" title="Aim: A model of CDigitalSurfaceContainer which defines the digital surface as the boundary of a given...">DigitalSetBoundary&lt;KSpace,DigitalSet&gt;</a> <a class="code" href="classDGtal_1_1DigitalSetBoundary.html" title="Aim: A model of CDigitalSurfaceContainer which defines the digital surface as the boundary of a given...">MyDigitalSurfaceContainer</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a name="_a2"></a><a class="code" href="classDGtal_1_1DigitalSurface.html" title="Aim: Represents a set of n-1-cells in a nD space, together with adjacency relation between these cell...">DigitalSurface&lt;MyDigitalSurfaceContainer&gt;</a> <a class="code" href="classDGtal_1_1DigitalSurface.html" title="Aim: Represents a set of n-1-cells in a nD space, together with adjacency relation between these cell...">MyDigitalSurface</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="classDGtal_1_1DigitalSurface.html#a40056dd099c93e7ab5dfc5196a56e550">MyDigitalSurface::ConstIterator</a> ConstIterator;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="classDGtal_1_1DigitalSurface.html#a637f8034aff12a2f65fe9cc47c95b8db" title="Defines the type for a vertex.">MyDigitalSurface::Vertex</a> Vertex;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="classDGtal_1_1DigitalSurface.html#aaa80abbd219d17cd225cc8f961be68f2">MyDigitalSurface::SurfelSet</a> SurfelSet;</div>
<div class="line"><span class="keyword">typedef</span> SurfelSet::iterator SurfelSetIterator;</div>
<div class="line"><span class="keyword">typedef</span> <a name="_a3"></a><a class="code" href="classDGtal_1_1BreadthFirstVisitor.html" title="Aim: This class is useful to perform a breadth-first exploration of a graph given a starting point or...">BreadthFirstVisitor&lt;MyDigitalSurface&gt;</a> <a class="code" href="classDGtal_1_1BreadthFirstVisitor.html" title="Aim: This class is useful to perform a breadth-first exploration of a graph given a starting point or...">Visitor</a>;</div>
<div class="line"><span class="keyword">struct </span>SegmentedPlane {</div>
<div class="line">  <a class="code" href="classDGtal_1_1COBANaivePlane.html">NaivePlaneComputer</a> plane;</div>
<div class="line">  <a name="_a4"></a><a class="code" href="classDGtal_1_1Color.html" title="Structure representing an RGB triple.">Color</a> color;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>VertexSize {</div>
<div class="line">  Vertex v;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size;</div>
<div class="line">  <span class="keyword">inline</span> VertexSize( <span class="keyword">const</span> Vertex &amp; aV, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aSize )</div>
<div class="line">    : v( aV ), size( aSize ) </div>
<div class="line">  {}</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">inline</span></div>
<div class="line"><span class="keywordtype">bool</span> operator&lt;( <span class="keyword">const</span> VertexSize &amp; vs1, <span class="keyword">const</span> VertexSize &amp; vs2 )</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> vs1.size &lt; vs2.size;</div>
<div class="line">} </div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv )</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// parse command line ----------------------------------------------</span></div>
<div class="line">  po::options_description general_opt(<span class="stringliteral">&quot;Allowed options are: &quot;</span>);</div>
<div class="line">  general_opt.add_options()</div>
<div class="line">    (<span class="stringliteral">&quot;help,h&quot;</span>, <span class="stringliteral">&quot;display this message&quot;</span>)</div>
<div class="line">    (<span class="stringliteral">&quot;input-file,i&quot;</span>, po::value&lt;std::string&gt;()-&gt;default_value( examplesPath + <span class="stringliteral">&quot;samples/Al.100.vol&quot;</span> ), <span class="stringliteral">&quot;the volume file (.vol)&quot;</span> )</div>
<div class="line">    (<span class="stringliteral">&quot;threshold,t&quot;</span>,  po::value&lt;unsigned int&gt;()-&gt;default_value(1), <span class="stringliteral">&quot;the value that defines the isosurface in the image (an integer between 0 and 255).&quot;</span> )</div>
<div class="line">    (<span class="stringliteral">&quot;width-num,w&quot;</span>,  po::value&lt;unsigned int&gt;()-&gt;default_value(1), <span class="stringliteral">&quot;the numerator of the rational width (a non-null integer).&quot;</span> )</div>
<div class="line">    (<span class="stringliteral">&quot;width-den,d&quot;</span>,  po::value&lt;unsigned int&gt;()-&gt;default_value(1), <span class="stringliteral">&quot;the denominator of the rational width (a non-null integer).&quot;</span> );</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">bool</span> parseOK = <span class="keyword">true</span>;</div>
<div class="line">  po::variables_map vm;</div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    po::store(po::parse_command_line(argc, argv, general_opt), vm);  </div>
<div class="line">  } <span class="keywordflow">catch</span> ( <span class="keyword">const</span> std::exception &amp; ex ) {</div>
<div class="line">    parseOK = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a name="a5"></a><a class="code" href="classDGtal_1_1Trace.html#a33ae7cd58d47594cee54640946c6b859">info</a>() &lt;&lt; <span class="stringliteral">&quot;Error checking program options: &quot;</span>&lt;&lt; ex.what()&lt;&lt; endl;</div>
<div class="line">  }</div>
<div class="line">  po::notify(vm);</div>
<div class="line">  <span class="keywordflow">if</span> ( ! parseOK || vm.count(<span class="stringliteral">&quot;help&quot;</span>) || ( argc &lt;= 1 ) )</div>
<div class="line">    {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0]</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; [-i &lt;fileName.vol&gt;] [-t &lt;threshold&gt;] [-w &lt;num&gt;] [-d &lt;den&gt;]&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Segments the surface at given threshold within given volume into digital planes of rational width num/den.&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; general_opt &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordtype">string</span> inputFilename = vm[<span class="stringliteral">&quot;input-file&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> threshold = vm[<span class="stringliteral">&quot;threshold&quot;</span>].as&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;();</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> widthNum = vm[<span class="stringliteral">&quot;width-num&quot;</span>].as&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;();</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> widthDen = vm[<span class="stringliteral">&quot;width-den&quot;</span>].as&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;();</div>
<div class="line"></div>
<div class="line">  QApplication application(argc,argv);</div>
<div class="line">  <span class="keyword">typedef</span> <a name="_a6"></a><a class="code" href="classDGtal_1_1ImageContainerBySTLVector.html">ImageSelector &lt; Domain, int&gt;::Type</a> <a name="_a7"></a><a class="code" href="classDGtal_1_1Image.html" title="Aim: implements association bewteen points lying in a digital domain and values.">Image</a>;</div>
<div class="line">  Image image = <a name="_a8"></a><a class="code" href="structDGtal_1_1VolReader.html" title="Aim: implements methods to read a &quot;Vol&quot; file format.">VolReader&lt;Image&gt;::importVol</a>(inputFilename);</div>
<div class="line">  <a class="code" href="namespaceDGtal_1_1Z2i.html#a371252c324e496cf8650757c1a2b4eb0">DigitalSet</a> set3d (image.<a name="a9"></a><a class="code" href="classDGtal_1_1Image.html#a28a1c55de323d0d0ec62d2db03eaf180">domain</a>());</div>
<div class="line">  <a name="_a10"></a><a class="code" href="structDGtal_1_1SetFromImage.html" title="Aim: Define utilities to convert a digital set into an image.">SetFromImage&lt;DigitalSet&gt;::append</a>&lt;Image&gt;(set3d, image, threshold,255);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a name="a11"></a><a class="code" href="classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Set up digital surface.&quot;</span> );</div>
<div class="line">  <span class="comment">// We initializes the cellular grid space used for defining the</span></div>
<div class="line">  <span class="comment">// digital surface.</span></div>
<div class="line">  <a class="code" href="namespaceDGtal_1_1Z2i.html#a6183d00ec6f8c4f81748fd20a52e5590">KSpace</a> ks;</div>
<div class="line">  <span class="keywordtype">bool</span> ok = ks.init( set3d.domain().lowerBound(),</div>
<div class="line">                     set3d.domain().upperBound(), true );</div>
<div class="line">  <span class="keywordflow">if</span> ( ! ok ) std::cerr &lt;&lt; <span class="stringliteral">&quot;[KSpace.init] Failed.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  <a name="_a12"></a><a class="code" href="classDGtal_1_1SurfelAdjacency.html">SurfelAdjacency&lt;KSpace::dimension&gt;</a> surfAdj( <span class="keyword">true</span> ); <span class="comment">// interior in all directions.</span></div>
<div class="line">  <a class="code" href="classDGtal_1_1DigitalSetBoundary.html" title="Aim: A model of CDigitalSurfaceContainer which defines the digital surface as the boundary of a given...">MyDigitalSurfaceContainer</a>* ptrSurfContainer = </div>
<div class="line">    <span class="keyword">new</span> <a class="code" href="classDGtal_1_1DigitalSetBoundary.html" title="Aim: A model of CDigitalSurfaceContainer which defines the digital surface as the boundary of a given...">MyDigitalSurfaceContainer</a>( ks, set3d, surfAdj );</div>
<div class="line">  <a class="code" href="classDGtal_1_1DigitalSurface.html" title="Aim: Represents a set of n-1-cells in a nD space, together with adjacency relation between these cell...">MyDigitalSurface</a> digSurf( ptrSurfContainer ); <span class="comment">// acquired</span></div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a name="a13"></a><a class="code" href="classDGtal_1_1Trace.html#a6c28382776be9139655b4851fabe4dda">endBlock</a>();</div>
<div class="line"></div>
<div class="line">  Point p;</div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a8fbe8c8d47ca5c36ced14284ac62613d">Dimension</a> axis;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb = digSurf.size();</div>
<div class="line"></div>
<div class="line">  <span class="comment">// First pass to find biggest planes.</span></div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;1) Segmentation first pass. Computes all planes so as to sort vertices by the plane size.&quot;</span> );</div>
<div class="line">  std::map&lt;Vertex,unsigned int&gt; v2size;</div>
<div class="line">  <a class="code" href="classDGtal_1_1COBANaivePlane.html">NaivePlaneComputer</a> planeComputer;</div>
<div class="line">  std::priority_queue&lt;VertexSize&gt; Q;</div>
<div class="line">  <span class="keywordflow">for</span> ( ConstIterator it = digSurf.begin(), itE= digSurf.end(); it != itE; ++it )</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> ( ( (++j) % 50 == 0 ) || ( j == nb ) ) <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a name="a14"></a><a class="code" href="classDGtal_1_1Trace.html#ad8efd553b31277903be115e7aa256f74">progressBar</a>( j, nb );</div>
<div class="line">      Vertex v = *it;</div>
<div class="line">      axis = ks.sOrthDir( v );</div>
<div class="line">      planeComputer.<a name="a15"></a><a class="code" href="classDGtal_1_1COBANaivePlane.html#a5079a90cd8a00262aacc109e747f83a2">init</a>( axis, 500, widthNum, widthDen );</div>
<div class="line">      <span class="comment">// The visitor takes care of all the breadth-first traversal.</span></div>
<div class="line">      <a class="code" href="classDGtal_1_1BreadthFirstVisitor.html" title="Aim: This class is useful to perform a breadth-first exploration of a graph given a starting point or...">Visitor</a> visitor( digSurf, v );</div>
<div class="line">      <span class="keywordflow">while</span> ( ! visitor.finished() )</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classDGtal_1_1BreadthFirstVisitor.html#ad66e84867d0eb0c092900af4df0ae026">Visitor::Node</a> node = visitor.current();</div>
<div class="line">          v = node.first;</div>
<div class="line">          axis = ks.sOrthDir( v );</div>
<div class="line">          p = ks.sCoords( ks.sDirectIncident( v, axis ) );</div>
<div class="line">          <span class="keywordtype">bool</span> isExtended = planeComputer.<a name="a16"></a><a class="code" href="classDGtal_1_1COBANaivePlane.html#ae1d21455f1bb45c5ca20560f5ccd94bc">extend</a>( p );</div>
<div class="line">          <span class="keywordflow">if</span> ( isExtended ) </div>
<div class="line">            <span class="comment">// surfel is in plane.</span></div>
<div class="line">            visitor.expand();</div>
<div class="line">          <span class="keywordflow">else</span> <span class="comment">// surfel is not in plane and should not be used in the visit.</span></div>
<div class="line">            visitor.ignore();</div>
<div class="line">        }</div>
<div class="line">      Q.push( VertexSize( v, planeComputer.<a name="a17"></a><a class="code" href="classDGtal_1_1COBANaivePlane.html#a694e2f4379a26175bea8a80feee19ca1">size</a>() ) );</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#a6c28382776be9139655b4851fabe4dda">endBlock</a>();</div>
<div class="line"></div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;2) Segmentation second pass. Visits vertices from the one with biggest plane to the one with smallest plane.&quot;</span> );</div>
<div class="line">  std::set&lt;Vertex&gt; processedVertices;</div>
<div class="line">  std::vector&lt;SegmentedPlane*&gt; segmentedPlanes;</div>
<div class="line">  std::map&lt;Vertex,SegmentedPlane*&gt; v2plane;</div>
<div class="line">  j = 0;</div>
<div class="line">  <span class="keywordflow">while</span> ( ! Q.empty() )</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> ( ( (++j) % 50 == 0 ) || ( j == nb ) ) <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#ad8efd553b31277903be115e7aa256f74">progressBar</a>( j, nb );</div>
<div class="line">      Vertex v = Q.top().v;</div>
<div class="line">      Q.pop();</div>
<div class="line">      <span class="keywordflow">if</span> ( processedVertices.find( v ) != processedVertices.end() ) <span class="comment">// already in set</span></div>
<div class="line">        <span class="keywordflow">continue</span>; <span class="comment">// process to next vertex</span></div>
<div class="line"></div>
<div class="line">      SegmentedPlane* ptrSegment = <span class="keyword">new</span> SegmentedPlane;</div>
<div class="line">      segmentedPlanes.push_back( ptrSegment ); <span class="comment">// to delete them afterwards.</span></div>
<div class="line">      axis = ks.sOrthDir( v );</div>
<div class="line">      ptrSegment-&gt;plane.init( axis, 500, widthNum, widthDen );</div>
<div class="line">      <span class="comment">// The visitor takes care of all the breadth-first traversal.</span></div>
<div class="line">      <a class="code" href="classDGtal_1_1BreadthFirstVisitor.html" title="Aim: This class is useful to perform a breadth-first exploration of a graph given a starting point or...">Visitor</a> visitor( digSurf, v );</div>
<div class="line">      <span class="keywordflow">while</span> ( ! visitor.finished() )</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classDGtal_1_1BreadthFirstVisitor.html#ad66e84867d0eb0c092900af4df0ae026">Visitor::Node</a> node = visitor.current();</div>
<div class="line">          v = node.first;</div>
<div class="line">          <span class="keywordflow">if</span> ( processedVertices.find( v ) == processedVertices.end() )</div>
<div class="line">            { <span class="comment">// Vertex is not in processedVertices</span></div>
<div class="line">              axis = ks.sOrthDir( v );</div>
<div class="line">              p = ks.sCoords( ks.sDirectIncident( v, axis ) );</div>
<div class="line">              <span class="keywordtype">bool</span> isExtended = ptrSegment-&gt;plane.extend( p );</div>
<div class="line">              <span class="keywordflow">if</span> ( isExtended ) </div>
<div class="line">                { <span class="comment">// surfel is in plane.</span></div>
<div class="line">                  processedVertices.insert( v );</div>
<div class="line">                  v2plane[ v ] = ptrSegment;</div>
<div class="line">                  visitor.expand();</div>
<div class="line">                }</div>
<div class="line">              <span class="keywordflow">else</span> <span class="comment">// surfel is not in plane and should not be used in the visit.</span></div>
<div class="line">                visitor.ignore();</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span> <span class="comment">// surfel is already in some plane.</span></div>
<div class="line">            visitor.ignore();</div>
<div class="line">        }</div>
<div class="line">      <span class="comment">// Assign random color for each plane.</span></div>
<div class="line">      ptrSegment-&gt;color = <a class="code" href="classDGtal_1_1Color.html" title="Structure representing an RGB triple.">Color</a>( random() % 256, random() % 256, random() % 256, 255 );</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code" href="classDGtal_1_1Trace.html#a6c28382776be9139655b4851fabe4dda">endBlock</a>();</div>
<div class="line"></div>
<div class="line">  <a name="_a18"></a><a class="code" href="classDGtal_1_1Viewer3D.html" title="Aim: Display 3D primitive (like PointVector, DigitalSetBySTLSet, Object ...). This class uses the lib...">Viewer3D</a> viewer;</div>
<div class="line">  viewer.show(); </div>
<div class="line">  <span class="keywordflow">for</span> ( std::map&lt;Vertex,SegmentedPlane*&gt;::const_iterator </div>
<div class="line">          it = v2plane.begin(), itE = v2plane.end();</div>
<div class="line">        it != itE; ++it )</div>
<div class="line">    {</div>
<div class="line">      viewer &lt;&lt; <a name="_a19"></a><a class="code" href="structDGtal_1_1CustomColors3D.html" title="Custom style class redefining the fill color and the gl_LINE/gl_POINT color. You can use DGtal::Color...">CustomColors3D</a>( it-&gt;second-&gt;color, it-&gt;second-&gt;color );</div>
<div class="line">      viewer &lt;&lt; ks.unsigns( it-&gt;first );</div>
<div class="line">    }</div>
<div class="line">  viewer &lt;&lt; Display3D::updateDisplay;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> ( std::vector&lt;SegmentedPlane*&gt;::iterator </div>
<div class="line">          it = segmentedPlanes.begin(), itE = segmentedPlanes.end(); </div>
<div class="line">        it != itE; ++it )</div>
<div class="line">    <span class="keyword">delete</span> *it;</div>
<div class="line">  segmentedPlanes.clear();</div>
<div class="line">  v2plane.clear();</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> application.exec();</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 22 2013 14:15:21 for DGtal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
