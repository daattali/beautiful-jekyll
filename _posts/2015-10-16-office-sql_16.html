---
layout: post
title: Office SQL
date: '2015-10-16T03:22:00.004-07:00'
author: syswow64
tags:
modified_time: '2020-01-17T04:20:28.179-08:00'
blogger_id: tag:blogger.com,1999:blog-4452544758446808584.post-8096750993971448995
blogger_orig_url: https://www.syswow64.co.uk/2015/10/office-sql_16.html
---

<div style="border-width: 100%; direction: ltr;"> <div style="direction: ltr; margin-left: 0in; margin-top: 0in; width: 5.5888in;"> <div style="direction: ltr; margin-left: 0in; margin-top: 0in; width: 5.5888in;"> <div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">-- Counts Office version</div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">select&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">count(Total.Name0) as Total_Systems,COUNT(office2003.Name0) as MSoffice2003,COUNT(Office2007.Name0) as MSOffice2007,COUNT(Office2010.Name0) as MsOffice2010, COUNT(Office2013.Name0) as MsOffice2013 </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">From&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(select vr.Name0 from v_R_System vr)&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">as Total&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(select distinct sys.Name0,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; displayname00 as OfficeEdition,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version00 as OfficeVersion&nbsp; from system_disc sys&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">add_remove_programs_data arp on sys.itemkey = arp.machineid where&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(displayname00 = 'Microsoft Office Basic Edition 2003'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">OR displayname00 = 'Microsoft Office Excel 2003'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">OR displayname00 = 'Microsoft Office Outlook 2003'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">OR displayname00 = 'Microsoft Office Personal Edition 2003'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">OR displayname00 = 'Microsoft Office Professional Edition 2003'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">OR displayname00 = 'Microsoft Office Small Business Edition 2003'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">OR displayname00 = 'Microsoft Office Standard Edition 2003')&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">and client0 = 1)as office2003&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">on Total.Name0=office2003.Name0&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(Select distinct sys.Name0,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; displayname00 as OfficeEdition,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version00 as OfficeVersion&nbsp; from system_disc sys&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">add_remove_programs_data arp on sys.itemkey = arp.machineid where&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(displayname00 like 'Microsoft Office Personal 2007'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional 2007'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional 2007 Trial'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional Hybrid 2007'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional Plus 2007'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional Plus 2007 (Beta)'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Standard 2007'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Standard 2007 Trial'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Ultimate 2007')&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">and sys.client0 = 1)as Office2007&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">on Total.Name0=office2007.Name0&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(select distinct sys.Name0,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; displayname00 as OfficeEdition,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version00 as OfficeVersion&nbsp; from system_disc sys&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">add_remove_programs_data arp on sys.itemkey = arp.machineid where&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(displayname00 like 'Microsoft Office 2010'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional Plus 2010'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Standard 2010'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional 2010'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Home and Student 2010'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Home and Business 2010'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Professional Plus 2010 (Beta)'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">or displayname00 like 'Microsoft Office Starter 2010 â€“ English')&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">and sys.client0 = 1) as office2010&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">on Total.Name0=office2010.Name0</div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join</div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(select distinct sys.Name0,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; displayname00 as OfficeEdition,&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version00 as OfficeVersion&nbsp; from system_disc sys&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">left join&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">add_remove_programs_data arp on sys.itemkey = arp.machineid where&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">(displayname00 like 'Microsoft Office Professional Plus 2013'&nbsp; )</div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">--or displayname00 like 'Microsoft Office Professional Plus 2013'&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">and sys.client0 = 1) as office2013&nbsp; </div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;"><br /></div><div style="font-family: Calibri; font-size: 11.0pt; margin: 0in;">on Total.Name0=office2013.Name0</div></div></div></div>